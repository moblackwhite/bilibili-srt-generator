1
00:00:00,000 --> 00:00:04,240
我们训练好了我们的BERT模型之后

2
00:00:04,240 --> 00:00:08,960
我们就要主要来做Fine Tuning了

3
00:00:08,960 --> 00:00:10,839
所以跟图片分类不一样

4
00:00:10,839 --> 00:00:13,080
图片分类是我训练好了ResNet之后

5
00:00:13,080 --> 00:00:15,720
我可以用来做图片分类

6
00:00:16,160 --> 00:00:18,080
它也是一个很正常的任务

7
00:00:18,080 --> 00:00:21,440
但是BERT它本身两个任务是没什么意义的

8
00:00:21,440 --> 00:00:24,760
就是说你很少是说真的给你做完性填空

9
00:00:24,760 --> 00:00:27,280
或者也很少说给你预测两个句子

10
00:00:27,280 --> 00:00:28,519
是不是同一个出现

11
00:00:28,640 --> 00:00:32,640
所以BERT主要就是用来给大家做微调用的

12
00:00:33,640 --> 00:00:35,479
好就是说微调怎么办

13
00:00:35,479 --> 00:00:36,519
微调就是说

14
00:00:36,920 --> 00:00:39,399
我给一个BERT训练好的BERT之后

15
00:00:39,560 --> 00:00:43,200
我的句子的地方

16
00:00:43,640 --> 00:00:45,879
就是你的句子开始符分类标是符

17
00:00:45,879 --> 00:00:47,239
然后你的比如说句子

18
00:00:47,239 --> 00:00:48,159
然后分个符

19
00:00:48,280 --> 00:00:49,840
中间可能是一个两个句子

20
00:00:50,239 --> 00:00:51,519
进入BERT之后

21
00:00:51,719 --> 00:00:56,760
它会对每一个token都会返回一个场位

22
00:00:56,799 --> 00:00:58,399
我们刚刚是128

23
00:00:58,399 --> 00:01:00,359
但是BERT的base是768

24
00:01:00,359 --> 00:01:02,679
然后BERTLodge是1024场的特征

25
00:01:03,119 --> 00:01:04,079
所以这些特征

26
00:01:04,480 --> 00:01:06,200
你可认为这些特征

27
00:01:06,200 --> 00:01:07,200
因为它是transformer

28
00:01:07,280 --> 00:01:10,200
所以它已经包含了整个句子的信息

29
00:01:10,799 --> 00:01:15,239
就你可认为这个特征是用这个词做query

30
00:01:15,280 --> 00:01:17,599
然后这些东西做上下文

31
00:01:17,599 --> 00:01:18,599
拿到的

32
00:01:18,799 --> 00:01:21,879
抽取了上下文信息的特征项量

33
00:01:22,799 --> 00:01:25,359
所以就是说你可认为它是一个很好的特征表示

34
00:01:25,640 --> 00:01:26,959
那么接下来就是说

35
00:01:27,640 --> 00:01:32,079
不同的任务会用到使用不同的

36
00:01:32,079 --> 00:01:32,879
这是个不同

37
00:01:33,239 --> 00:01:35,239
使用不同的不是特征

38
00:01:35,400 --> 00:01:36,400
不同的特征

39
00:01:37,000 --> 00:01:37,640
不是特性

40
00:01:38,400 --> 00:01:38,599
好

41
00:01:38,599 --> 00:01:40,560
我们来看一下具体具体举一个例子

42
00:01:41,719 --> 00:01:43,079
第一个句子是说

43
00:01:43,760 --> 00:01:46,879
假设我要做一个单句子的分类

44
00:01:46,879 --> 00:01:48,799
就是说这个电影很棒

45
00:01:48,799 --> 00:01:50,519
我来预测说你是个正面的评价

46
00:01:50,519 --> 00:01:51,599
还是个负面评价

47
00:01:51,640 --> 00:01:52,640
那么怎么办呢

48
00:01:52,680 --> 00:01:54,920
就是说把一个句子输入进来

49
00:01:55,359 --> 00:01:57,480
然后把句子开始的class

50
00:01:57,480 --> 00:01:59,359
这个东西对应的项量拿出来

51
00:01:59,560 --> 00:02:01,920
就跟刚刚我们做下一个句子预测有点像

52
00:02:02,359 --> 00:02:03,680
把它的项量拿出来

53
00:02:03,879 --> 00:02:05,200
就后面现在就不要了

54
00:02:05,959 --> 00:02:09,000
然后把它丢到我的dense

55
00:02:09,000 --> 00:02:10,800
就是说一个二分类也好

56
00:02:10,800 --> 00:02:13,079
n分类问题的一个输出层里面

57
00:02:13,079 --> 00:02:14,680
做softmax做分类

58
00:02:15,919 --> 00:02:17,159
如果你是一个句子

59
00:02:17,520 --> 00:02:19,000
一对句子的话一样的

60
00:02:19,079 --> 00:02:21,360
就是你这么表示过来

61
00:02:21,400 --> 00:02:25,039
然后你把它这个句子

62
00:02:25,039 --> 00:02:26,319
分割幅表示起来

63
00:02:26,359 --> 00:02:27,000
还是一样的

64
00:02:27,000 --> 00:02:29,479
还是拿到第一个词的项量

65
00:02:29,719 --> 00:02:31,199
做到你的分类器里面

66
00:02:32,400 --> 00:02:34,399
当然你要问说你这个东西

67
00:02:34,799 --> 00:02:37,280
为什么你用这个不是用别的呢

68
00:02:37,639 --> 00:02:38,519
有两个原因

69
00:02:38,519 --> 00:02:39,639
一个原因是说

70
00:02:39,639 --> 00:02:43,079
我们刚刚不是说有去判断两个句子

71
00:02:43,280 --> 00:02:44,639
在做预训练的时候

72
00:02:44,639 --> 00:02:46,479
有判断两个句子pair

73
00:02:46,519 --> 00:02:47,639
是不是一个pair的时候

74
00:02:47,639 --> 00:02:48,519
我用的是它

75
00:02:48,840 --> 00:02:51,000
所以我多多少少告诉Bert说

76
00:02:51,319 --> 00:02:53,639
这个东西我是主要用来做

77
00:02:53,640 --> 00:02:57,240
说句子级别的分类用的项量

78
00:02:57,240 --> 00:02:59,000
所以你尽量把它的输出

79
00:02:59,080 --> 00:03:00,600
弄得适合做这个事情

80
00:03:01,960 --> 00:03:02,720
这个是第一个原因

81
00:03:02,720 --> 00:03:03,680
第二个原因就是说

82
00:03:03,680 --> 00:03:05,600
其实当然你换了别的也可以

83
00:03:05,600 --> 00:03:06,360
反正你要fine tune

84
00:03:06,800 --> 00:03:08,200
反正就是说你在训练的时候

85
00:03:08,200 --> 00:03:10,480
我也会去更新我的Bert的权重

86
00:03:10,520 --> 00:03:13,640
所以使得是说我可以改变它的权重

87
00:03:13,640 --> 00:03:14,840
使得这个东西输出

88
00:03:15,280 --> 00:03:17,760
是想含了我要的东西

89
00:03:18,280 --> 00:03:18,880
OK

90
00:03:19,840 --> 00:03:21,400
这个是做句子分类

91
00:03:22,400 --> 00:03:23,439
另外一个是做

92
00:03:23,439 --> 00:03:25,840
比如说命名实体识别

93
00:03:25,960 --> 00:03:27,719
就是说识别一个词元

94
00:03:27,879 --> 00:03:28,840
是不是一个实体

95
00:03:28,840 --> 00:03:30,439
比如说是不是一个人名

96
00:03:30,840 --> 00:03:32,080
是不是一个机构名字

97
00:03:32,360 --> 00:03:33,319
是不是一个位置

98
00:03:33,439 --> 00:03:35,640
是不是一些那些在NOP里面

99
00:03:35,640 --> 00:03:36,319
叫做NER

100
00:03:37,040 --> 00:03:38,400
就是NAND entity

101
00:03:38,480 --> 00:03:39,560
就是说识别一个东西

102
00:03:39,560 --> 00:03:40,560
是不是一个

103
00:03:40,560 --> 00:03:43,480
比如说是iPhone X

104
00:03:43,800 --> 00:03:44,960
还是什么

105
00:03:45,319 --> 00:03:46,640
某个商标

106
00:03:46,640 --> 00:03:48,040
还是某个人民的东西

107
00:03:48,280 --> 00:03:50,159
这个东西通常是非常

108
00:03:50,439 --> 00:03:51,560
对NOP是有用的

109
00:03:51,840 --> 00:03:52,520
就是说

110
00:03:53,079 --> 00:03:53,799
NOP说

111
00:03:53,799 --> 00:03:55,199
你说我跟你告诉一个东西

112
00:03:55,199 --> 00:03:56,439
你根本就搞不清楚

113
00:03:56,439 --> 00:03:56,960
我说的

114
00:03:56,960 --> 00:03:58,479
我说apple是指苹果

115
00:03:58,479 --> 00:03:59,359
而不是指的

116
00:03:59,919 --> 00:04:00,639
我要买的

117
00:04:00,639 --> 00:04:02,199
我要真的吃的苹果

118
00:04:02,240 --> 00:04:03,240
还是要用的苹果

119
00:04:03,240 --> 00:04:03,599
对吧

120
00:04:03,599 --> 00:04:06,879
所以就说你要对这个东西做得很好

121
00:04:06,919 --> 00:04:08,120
你这个东西做得很好

122
00:04:08,120 --> 00:04:10,039
通常说NOP能解决很多

123
00:04:10,199 --> 00:04:11,840
看上去很傻的一些bad case

124
00:04:11,840 --> 00:04:12,359
能够解决

125
00:04:13,599 --> 00:04:15,879
所以这个是一个非常重要的应用

126
00:04:16,839 --> 00:04:17,439
它怎么做

127
00:04:17,600 --> 00:04:18,360
就是说

128
00:04:18,680 --> 00:04:20,120
给一个句子进来

129
00:04:20,200 --> 00:04:23,800
它把每一个非特殊次元的

130
00:04:23,800 --> 00:04:25,000
全联证拿出来

131
00:04:25,439 --> 00:04:25,920
对吧

132
00:04:25,960 --> 00:04:28,520
就是说你那些非特殊次元

133
00:04:28,520 --> 00:04:29,280
那些class

134
00:04:29,439 --> 00:04:30,120
separate的

135
00:04:30,120 --> 00:04:30,800
是不要了

136
00:04:31,040 --> 00:04:33,080
那些真正的token拿出来之后

137
00:04:33,240 --> 00:04:34,400
它的项量拿出来

138
00:04:34,400 --> 00:04:37,440
然后把它做进全联监测

139
00:04:37,520 --> 00:04:38,240
就是说

140
00:04:38,280 --> 00:04:40,000
对每一个词

141
00:04:40,320 --> 00:04:43,360
我来判断它是不是NER

142
00:04:43,360 --> 00:04:45,040
就是一个二分类问题

143
00:04:45,040 --> 00:04:45,480
对吧

144
00:04:45,520 --> 00:04:46,440
但你可以做多分类

145
00:04:46,560 --> 00:04:47,760
就是说你可以分类是人民

146
00:04:47,760 --> 00:04:48,240
是机构

147
00:04:48,240 --> 00:04:48,680
是位置

148
00:04:48,680 --> 00:04:51,920
还是说非实体命名

149
00:04:52,759 --> 00:04:53,120
OK

150
00:04:53,120 --> 00:04:53,920
这就是

151
00:04:54,800 --> 00:04:56,040
就是说对每一个

152
00:04:56,040 --> 00:04:57,759
刚刚是一个句子级别的分类

153
00:04:57,959 --> 00:05:00,160
现在是一个词级别的分类

154
00:05:01,759 --> 00:05:02,639
但还有是说

155
00:05:02,639 --> 00:05:04,480
我们在上一次讲的时候

156
00:05:04,480 --> 00:05:05,680
大家有问到这个问题

157
00:05:05,840 --> 00:05:06,560
就是说

158
00:05:07,519 --> 00:05:08,800
做问题回答

159
00:05:08,800 --> 00:05:09,879
问题回答是个什么东西

160
00:05:10,120 --> 00:05:10,920
就是说

161
00:05:11,879 --> 00:05:13,519
给定一个问题

162
00:05:14,160 --> 00:05:15,759
和它的描述文字

163
00:05:15,960 --> 00:05:17,800
就是我说给你一段话

164
00:05:17,920 --> 00:05:18,879
然后再问你一个问题

165
00:05:18,879 --> 00:05:20,000
比如说我给一段话说

166
00:05:22,520 --> 00:05:22,960
举个例子

167
00:05:23,120 --> 00:05:23,759
谁

168
00:05:23,759 --> 00:05:26,639
我说我给一个谁的生平的介绍

169
00:05:27,360 --> 00:05:28,680
然后我给了你之后

170
00:05:28,680 --> 00:05:29,759
我告诉你说

171
00:05:29,800 --> 00:05:30,759
我问你个问题

172
00:05:30,960 --> 00:05:33,720
那个人是在哪一年出生的

173
00:05:34,600 --> 00:05:36,040
那么你的回答是干嘛

174
00:05:36,080 --> 00:05:37,600
你的回答就是把年份

175
00:05:37,759 --> 00:05:39,519
在年份肯定应该是出

176
00:05:39,519 --> 00:05:41,560
应该出现在你的描述文字里面

177
00:05:42,639 --> 00:05:44,879
你去把

178
00:05:46,160 --> 00:05:47,040
你把你

179
00:05:47,200 --> 00:05:48,040
你就去把

180
00:05:49,400 --> 00:05:51,800
描述年份

181
00:05:52,240 --> 00:05:54,120
那个词给我找出来就行了

182
00:05:54,480 --> 00:05:56,720
当然你可能是要回答一段话

183
00:05:56,920 --> 00:05:57,840
就是说你的问题

184
00:05:57,840 --> 00:05:58,720
可能是一句话

185
00:05:58,760 --> 00:05:59,600
中间一句话

186
00:05:59,600 --> 00:06:01,840
那么你就把一句话的开头和结

187
00:06:01,840 --> 00:06:03,640
你就把那一句话抠给我就行了

188
00:06:04,840 --> 00:06:06,000
那么他怎么做呢

189
00:06:06,640 --> 00:06:08,160
他这个东西就是说

190
00:06:08,840 --> 00:06:10,759
问题和描述文字

191
00:06:10,800 --> 00:06:12,480
他做成两句话

192
00:06:12,480 --> 00:06:13,759
但描述文字是一段话

193
00:06:13,800 --> 00:06:14,200
不要紧

194
00:06:14,200 --> 00:06:15,400
就是我反正我就放一个

195
00:06:15,400 --> 00:06:16,480
很长很长的序列

196
00:06:17,360 --> 00:06:18,080
这也是为什么

197
00:06:18,080 --> 00:06:19,400
BERT通常可以做到

198
00:06:20,160 --> 00:06:22,080
应该是长度

199
00:06:22,080 --> 00:06:23,280
可能做到1.24

200
00:06:23,600 --> 00:06:25,960
是因为它确实它的

201
00:06:26,120 --> 00:06:27,520
它的输进去的句子

202
00:06:27,520 --> 00:06:28,600
可能会比较长

203
00:06:29,320 --> 00:06:30,600
然后第一个是什么

204
00:06:30,600 --> 00:06:31,800
第一个是你的问题

205
00:06:32,240 --> 00:06:33,480
问题不需要输出

206
00:06:33,840 --> 00:06:36,200
第二个是你的描述文字

207
00:06:36,200 --> 00:06:37,360
会比较长一点

208
00:06:38,000 --> 00:06:38,879
那么你的分类

209
00:06:38,879 --> 00:06:40,160
你分类要干嘛

210
00:06:40,360 --> 00:06:42,600
你的分类器要干的事情是说

211
00:06:43,320 --> 00:06:45,160
对于每一个词

212
00:06:45,160 --> 00:06:46,759
就是说描述文

213
00:06:47,560 --> 00:06:48,480
字里面的词

214
00:06:49,840 --> 00:06:51,120
去预测

215
00:06:51,480 --> 00:06:53,520
它每个词

216
00:06:53,560 --> 00:06:56,800
是不是答案的开始

217
00:06:58,240 --> 00:07:00,640
还是开始的那一个词

218
00:07:00,640 --> 00:07:02,400
还是结束的那一个词

219
00:07:02,600 --> 00:07:03,600
还是不是

220
00:07:03,640 --> 00:07:05,080
就是一个三分的问题

221
00:07:06,160 --> 00:07:06,439
OK

222
00:07:06,439 --> 00:07:08,600
这个是一个最简单的

223
00:07:09,879 --> 00:07:10,280
用处

224
00:07:10,400 --> 00:07:11,759
当然你可以做稍微fancy的

225
00:07:11,759 --> 00:07:12,360
因为你知道

226
00:07:12,360 --> 00:07:14,600
就是又开始

227
00:07:14,600 --> 00:07:15,600
然后再结束后面

228
00:07:15,600 --> 00:07:16,560
当然你可以做一点点

229
00:07:16,600 --> 00:07:18,000
这样子的别的事情

230
00:07:18,000 --> 00:07:18,839
但是最简单来讲

231
00:07:18,839 --> 00:07:19,480
就是说

232
00:07:19,759 --> 00:07:20,519
对每个词

233
00:07:20,519 --> 00:07:21,680
我就预测说

234
00:07:21,720 --> 00:07:23,160
你是不是答案的开始

235
00:07:23,639 --> 00:07:25,000
还是你是答案的结束

236
00:07:25,040 --> 00:07:26,680
还是别的

237
00:07:27,040 --> 00:07:28,319
所以这样子的话

238
00:07:28,319 --> 00:07:29,639
就算做成一个

239
00:07:30,040 --> 00:07:31,480
三分的问题

240
00:07:31,519 --> 00:07:33,360
就可以做一个QA了

241
00:07:33,840 --> 00:07:35,480
所以基本上可以看到是说

242
00:07:35,720 --> 00:07:39,079
虽然你QA也好

243
00:07:39,319 --> 00:07:40,480
句子分类也好

244
00:07:40,480 --> 00:07:41,720
每个词分类也好

245
00:07:41,800 --> 00:07:43,319
它确实还是不一样的

246
00:07:43,639 --> 00:07:45,360
就是说它要的东西不一样

247
00:07:45,360 --> 00:07:46,800
但是对于BERT来讲

248
00:07:47,360 --> 00:07:50,199
你都是做成一个句子对进去

249
00:07:50,199 --> 00:07:51,480
然后最后的最后

250
00:07:52,080 --> 00:07:54,800
你就是一个全连阶层

251
00:07:56,080 --> 00:07:56,400
OK

252
00:07:56,400 --> 00:07:58,480
就是说全连阶层去看的

253
00:07:58,480 --> 00:08:00,560
哪一个要看到哪一个token的

254
00:08:00,560 --> 00:08:02,360
那些embedding可能会不一样

255
00:08:02,639 --> 00:08:04,199
全连阶层大小会不一样

256
00:08:04,199 --> 00:08:05,280
但整体来讲

257
00:08:05,280 --> 00:08:07,160
你最后这一块的

258
00:08:07,160 --> 00:08:08,280
所谓的权重

259
00:08:08,280 --> 00:08:10,960
你都是可以在刚刚我们训练好的

260
00:08:10,960 --> 00:08:12,240
模型里面拿过来

261
00:08:12,720 --> 00:08:15,199
然后你唯一要从random开始

262
00:08:15,319 --> 00:08:16,479
就随机开始训练的话

263
00:08:16,479 --> 00:08:17,920
就是最后输出层

264
00:08:17,920 --> 00:08:20,680
是你要从真的从零开始训练的

265
00:08:21,360 --> 00:08:22,959
所以基本上可以看到是说

266
00:08:23,240 --> 00:08:23,800
总结一下

267
00:08:23,800 --> 00:08:24,479
就是说

268
00:08:25,879 --> 00:08:27,279
就算你的NOP的任务

269
00:08:28,000 --> 00:08:28,879
各有不同

270
00:08:29,199 --> 00:08:30,879
然后使用BERT微调的时候

271
00:08:31,240 --> 00:08:34,519
你基本上只需要增加一个输出层

272
00:08:34,879 --> 00:08:36,120
你就不需要去管说

273
00:08:36,319 --> 00:08:38,279
我要怎么样表示句子信息

274
00:08:38,279 --> 00:08:39,159
段落信息

275
00:08:39,159 --> 00:08:39,879
词信息

276
00:08:39,879 --> 00:08:41,159
或者什么样的东西

277
00:08:41,159 --> 00:08:43,759
BERT你假设BERT已经全部给你做好了

278
00:08:44,000 --> 00:08:47,080
你只要加一个简单的输出层就行了

279
00:08:47,679 --> 00:08:50,519
但是是说根据任务的会不一样

280
00:08:51,120 --> 00:08:52,399
它的输出的表示

281
00:08:52,600 --> 00:08:54,360
还是会有一点点不一样的

282
00:08:54,360 --> 00:08:56,039
就是说你要多一个类

283
00:08:56,840 --> 00:09:00,600
以及说你需要的哪些词的BERT特征

284
00:09:00,600 --> 00:09:02,000
也会有一点点不一样

285
00:09:02,759 --> 00:09:02,919
OK

286
00:09:02,919 --> 00:09:03,759
但整体来讲

287
00:09:03,759 --> 00:09:05,279
他用了BERT之后

288
00:09:05,759 --> 00:09:07,799
让你的整个fine tuning

289
00:09:07,799 --> 00:09:11,279
都是相比之前会有简单很多

290
00:09:11,279 --> 00:09:12,639
而且通常来说

291
00:09:12,720 --> 00:09:13,919
BERT对你的提升

292
00:09:14,120 --> 00:09:16,840
整个任务的提升也是非常显著的

293
00:09:17,759 --> 00:09:19,960
你简单用了之后

294
00:09:19,960 --> 00:09:21,799
比你之前从零开始训练

295
00:09:21,799 --> 00:09:23,399
可能效果会好很多

296
00:09:23,840 --> 00:09:25,960
这也是说BERT出来之后

297
00:09:26,080 --> 00:09:27,080
为什么被

298
00:09:27,759 --> 00:09:29,399
他先自己刷了一下榜

299
00:09:29,439 --> 00:09:31,960
然后大家在持续的不断的去刷榜

300
00:09:32,000 --> 00:09:35,000
以至于说现在的整个NOP领域

301
00:09:35,159 --> 00:09:37,759
也是基本上转向这种

302
00:09:37,759 --> 00:09:39,279
基于fine tune的路线

303
00:09:39,600 --> 00:09:41,679
计算机视觉早在几年前已经转了

304
00:09:41,680 --> 00:09:44,320
现在是NOP也是这样子了

