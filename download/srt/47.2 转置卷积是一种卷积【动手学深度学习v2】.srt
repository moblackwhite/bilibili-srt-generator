1
00:00:00,000 --> 00:00:03,080
我们在上个星期讲转制卷机的时候

2
00:00:03,080 --> 00:00:04,120
大家有很多问题

3
00:00:04,120 --> 00:00:08,000
所以我觉得有必要我们再从另外一个角度

4
00:00:08,000 --> 00:00:11,120
再来给大家解释一下什么是转制卷机

5
00:00:12,599 --> 00:00:15,800
首先转制卷机它其实是一种卷机

6
00:00:16,480 --> 00:00:18,199
它不一样的地方是说

7
00:00:18,199 --> 00:00:22,400
它对你的输入和核做了一下重新的排列

8
00:00:23,920 --> 00:00:25,320
同卷机相比

9
00:00:25,320 --> 00:00:27,960
卷机一般是说做下裁样

10
00:00:27,960 --> 00:00:30,880
就是说把你的输入的高宽变得更小

11
00:00:31,160 --> 00:00:33,719
转制卷机一般是做上裁样

12
00:00:33,719 --> 00:00:35,640
就是把你的输入的高宽变大

13
00:00:37,079 --> 00:00:40,679
如果说卷机将你的输入的高宽

14
00:00:40,679 --> 00:00:43,600
从HW变成了H' W'的话

15
00:00:43,600 --> 00:00:45,159
我们在上周也讲过

16
00:00:45,159 --> 00:00:48,560
使用同样超参数的转制卷机

17
00:00:48,560 --> 00:00:52,840
就会将你从H' W'变回到H和W

18
00:00:53,040 --> 00:00:54,359
所以就是说你可以认为

19
00:00:54,359 --> 00:00:56,600
在同样的超参数的情况下

20
00:00:56,600 --> 00:01:00,000
在形状上转制卷机和卷机是一个逆变

21
00:01:00,000 --> 00:01:03,000
所以接下来我们给大家讲一下

22
00:01:03,000 --> 00:01:08,200
说具体是怎么样把转制卷机换算成卷机的

23
00:01:08,920 --> 00:01:10,879
首先我们看一个最简单的情况

24
00:01:10,879 --> 00:01:13,960
当你的填充为0和不复为1的时候

25
00:01:14,960 --> 00:01:16,319
我们这里举一个例子

26
00:01:16,480 --> 00:01:19,840
就是说我们的输入是一个2×2的输入

27
00:01:19,840 --> 00:01:21,599
我们的核也是一个2×2

28
00:01:21,840 --> 00:01:24,599
这个例子是我们上节课用过的例子

29
00:01:24,680 --> 00:01:26,400
让我们从另外一个角度来解释

30
00:01:26,400 --> 00:01:27,560
它是怎么计算的

31
00:01:28,160 --> 00:01:30,920
首先我们如果想把它变成卷机的话

32
00:01:31,240 --> 00:01:32,280
我们怎么办呢

33
00:01:32,440 --> 00:01:35,760
我们先对输入的上下左右

34
00:01:35,880 --> 00:01:38,480
都填充K-1行或者列

35
00:01:38,960 --> 00:01:40,720
K就是你的核的大小

36
00:01:40,960 --> 00:01:41,800
这里核等于2

37
00:01:41,800 --> 00:01:44,600
所以你填充的是上面一行

38
00:01:44,600 --> 00:01:45,120
下面一行

39
00:01:45,120 --> 00:01:45,720
左边一行

40
00:01:45,720 --> 00:01:46,160
右边一行

41
00:01:46,160 --> 00:01:46,920
左边一列

42
00:01:46,920 --> 00:01:47,600
右边一列

43
00:01:47,720 --> 00:01:49,160
所以看到了就是说

44
00:01:49,160 --> 00:01:52,600
你填充的就是这些蓝色的0的区域

45
00:01:53,600 --> 00:01:54,840
对核矩阵的话

46
00:01:55,040 --> 00:01:57,440
我们做上下左右的翻转

47
00:01:57,560 --> 00:02:01,040
就是说从0123变成了3210

48
00:02:02,120 --> 00:02:04,120
那么得到变换之后

49
00:02:04,120 --> 00:02:06,480
我们就对它做正常的卷机

50
00:02:06,520 --> 00:02:08,320
就是填充为0不复为1

51
00:02:08,480 --> 00:02:11,600
这会4×4的输入和2×2的核做卷机

52
00:02:11,600 --> 00:02:13,360
那么得到一个3×3的输出

53
00:02:13,920 --> 00:02:15,439
这个就是我们的输出

54
00:02:15,480 --> 00:02:18,760
它就等价于说转制卷机的输出

55
00:02:19,040 --> 00:02:21,000
这个输出我们也是在上节课讲过

56
00:02:21,000 --> 00:02:23,360
它的值是怎么算出来的

57
00:02:24,719 --> 00:02:26,599
接下来看一个稍微复杂一点

58
00:02:26,759 --> 00:02:29,000
就是填充为p的时候怎么办

59
00:02:29,840 --> 00:02:31,199
填充为p我们知道

60
00:02:31,639 --> 00:02:32,960
对于卷机来讲

61
00:02:32,960 --> 00:02:36,199
加填充就使得输入和输出会变大

62
00:02:36,840 --> 00:02:38,520
但是对转制卷机来说

63
00:02:38,520 --> 00:02:39,439
你加了填充

64
00:02:39,439 --> 00:02:41,360
你的输出就会变小

65
00:02:41,520 --> 00:02:43,240
所以当你的填充为p的时候

66
00:02:43,680 --> 00:02:45,039
你对输入的填充

67
00:02:45,039 --> 00:02:47,159
就会变成了k-p-1

68
00:02:48,280 --> 00:02:49,560
如果k是等于2

69
00:02:49,560 --> 00:02:50,319
我们这个情况

70
00:02:50,479 --> 00:02:51,959
p也是等于1的时候

71
00:02:52,000 --> 00:02:53,400
那么你就等于0了

72
00:02:53,400 --> 00:02:54,560
就是说我们的输入

73
00:02:54,560 --> 00:02:58,479
就会不会填充任何东西的这个地方

74
00:02:59,959 --> 00:03:01,319
然后加核矩阵

75
00:03:01,479 --> 00:03:02,120
还是一样的

76
00:03:02,120 --> 00:03:03,759
做上下左右的翻转

77
00:03:03,919 --> 00:03:06,599
最后做卷机会得到一个单输出4

78
00:03:06,959 --> 00:03:09,919
这也是我们在上节课讲过的

79
00:03:10,319 --> 00:03:11,639
代码实现的例子

80
00:03:12,359 --> 00:03:13,840
最注意一点就是说

81
00:03:14,039 --> 00:03:16,560
你不管你的转制卷机的填充是多少

82
00:03:16,840 --> 00:03:19,919
最后做换算成卷机之后

83
00:03:19,920 --> 00:03:21,360
你的卷机是正常卷机

84
00:03:21,360 --> 00:03:22,400
就是填充为0

85
00:03:22,400 --> 00:03:23,040
不复为1

86
00:03:23,280 --> 00:03:25,880
跟你前面填充和不复是无关的

87
00:03:27,120 --> 00:03:29,320
那么再考虑一个一般情况的例子

88
00:03:29,320 --> 00:03:31,160
就是说我的填充为p

89
00:03:31,160 --> 00:03:32,520
我的不复为s

90
00:03:33,960 --> 00:03:35,040
不复我们知道

91
00:03:35,040 --> 00:03:36,320
我们在卷机的时候

92
00:03:36,320 --> 00:03:36,880
加入不复

93
00:03:36,880 --> 00:03:39,560
就会把高宽成倍的减少

94
00:03:39,760 --> 00:03:41,720
对于转制卷机来讲

95
00:03:41,720 --> 00:03:44,880
它就会是成倍的增加

96
00:03:45,880 --> 00:03:47,240
那么可以看到是说

97
00:03:47,240 --> 00:03:49,080
我们实际上做的是说

98
00:03:49,120 --> 00:03:51,080
在行和列之间

99
00:03:51,560 --> 00:03:54,920
我们再插入了s-1行或者列

100
00:03:55,760 --> 00:03:57,240
可以看一下具体的情况

101
00:03:57,240 --> 00:03:59,480
就是说我们是一个2×2的输入

102
00:03:59,520 --> 00:04:00,640
那么行和列之间

103
00:04:00,640 --> 00:04:02,040
就是说我们有两个之间

104
00:04:02,880 --> 00:04:04,600
列之间行之间

105
00:04:04,920 --> 00:04:06,640
然后我们的s等于2的话

106
00:04:06,640 --> 00:04:08,640
那我们就会插入一行或者一列

107
00:04:08,840 --> 00:04:10,160
所以你看到的是

108
00:04:11,640 --> 00:04:13,360
这一行这一列

109
00:04:13,360 --> 00:04:16,000
就是因为由于s变成2的时候

110
00:04:16,000 --> 00:04:17,280
加入了

111
00:04:18,280 --> 00:04:20,920
那么接下来是填充边框

112
00:04:21,680 --> 00:04:23,040
我们现在p等于0

113
00:04:23,160 --> 00:04:24,760
我们这个粒子里面p等于0

114
00:04:24,800 --> 00:04:27,560
所以就是k-p-1是等于1

115
00:04:27,560 --> 00:04:29,120
所以我们跟之前一样的

116
00:04:29,120 --> 00:04:32,160
在填充边上的这些列

117
00:04:33,760 --> 00:04:36,760
那么之后我们对和矩阵做反转

118
00:04:36,760 --> 00:04:38,920
然后再做正常的卷机

119
00:04:39,280 --> 00:04:40,320
它就是填充为0

120
00:04:40,320 --> 00:04:40,920
不复为1

121
00:04:40,920 --> 00:04:43,200
会得到一个4×4的输出

122
00:04:44,120 --> 00:04:46,720
所以基本上这也是

123
00:04:46,720 --> 00:04:48,720
我们在上节课讲过的例子

124
00:04:49,440 --> 00:04:51,400
基本上看到是我们在这个地方

125
00:04:51,840 --> 00:04:53,920
已经将输入2×2

126
00:04:53,920 --> 00:04:56,240
变成了它的两倍大小4×4

127
00:04:58,680 --> 00:04:59,520
那么总结一下

128
00:04:59,520 --> 00:05:02,240
就是说形状我们是怎么换算的

129
00:05:02,920 --> 00:05:05,280
假设我的输入的高

130
00:05:05,280 --> 00:05:06,880
或者是宽为n的情况下

131
00:05:07,440 --> 00:05:11,160
那么和是k填充和p

132
00:05:11,240 --> 00:05:12,480
不复为s

133
00:05:12,760 --> 00:05:14,120
那么转制卷机

134
00:05:14,120 --> 00:05:16,360
它对于新的高或者宽

135
00:05:16,360 --> 00:05:18,920
它是换算是n'

136
00:05:18,920 --> 00:05:21,120
等于s×n

137
00:05:21,120 --> 00:05:24,400
加上k-2p-s

138
00:05:24,400 --> 00:05:25,840
我们这个p是说

139
00:05:26,439 --> 00:05:27,600
讲的是上填充

140
00:05:27,840 --> 00:05:28,759
或者下填充

141
00:05:28,759 --> 00:05:31,920
也没有是整个上下的填充加起来

142
00:05:33,120 --> 00:05:36,520
如果我们考虑同样超三数的卷机的话

143
00:05:36,520 --> 00:05:38,920
那么我们的卷机n'的输出

144
00:05:38,920 --> 00:05:41,319
就是n-k-2p

145
00:05:41,319 --> 00:05:42,600
加上s

146
00:05:43,080 --> 00:05:43,800
除以s

147
00:05:43,800 --> 00:05:45,199
再取一个下整数

148
00:05:46,439 --> 00:05:47,920
所以我们可以看到是说

149
00:05:47,920 --> 00:05:50,920
你n这个东西如果不被整除的话

150
00:05:50,920 --> 00:05:52,600
你把你n增加一点点

151
00:05:52,600 --> 00:05:54,240
是不会影响你的输出的

152
00:05:55,240 --> 00:05:57,400
所以卷机其实是

153
00:05:57,400 --> 00:06:00,720
当你增加n的时候

154
00:06:01,120 --> 00:06:03,480
你可能会导致n'不会变化

155
00:06:03,600 --> 00:06:04,920
如果你要做力变化的话

156
00:06:04,920 --> 00:06:06,800
我们其实需要特别的考虑

157
00:06:07,000 --> 00:06:09,160
就是说你能推出来说

158
00:06:09,160 --> 00:06:10,480
我的输入的卷机

159
00:06:10,720 --> 00:06:13,720
n是大于等于s×s'

160
00:06:13,720 --> 00:06:15,720
加上k-2p-s

161
00:06:16,520 --> 00:06:18,920
如果你刚好这个地方是整除的话

162
00:06:18,920 --> 00:06:20,400
那所谓的整除

163
00:06:20,400 --> 00:06:24,120
就是你许的最小的输入n

164
00:06:24,120 --> 00:06:26,199
能达到我同样的n'的话

165
00:06:26,199 --> 00:06:28,199
那么这个地方是可以画等号的

166
00:06:29,400 --> 00:06:30,840
如果你画了等号的话

167
00:06:30,840 --> 00:06:32,920
你会发现它跟上面这个公式

168
00:06:33,080 --> 00:06:34,800
这两个公式就是一个逆公式了

169
00:06:34,800 --> 00:06:37,199
就是把n和n'做了交换

170
00:06:37,199 --> 00:06:38,120
别的都是一样的

171
00:06:38,120 --> 00:06:38,920
因为就是说

172
00:06:38,920 --> 00:06:41,280
k-2p-s这一项是一样的

173
00:06:42,000 --> 00:06:42,960
所以就是说

174
00:06:43,520 --> 00:06:46,319
为什么说转制卷机和卷机

175
00:06:46,319 --> 00:06:48,240
在同样的超参数情况下

176
00:06:48,240 --> 00:06:49,279
其实是个力变化

177
00:06:49,279 --> 00:06:50,399
在形状上来说

178
00:06:51,040 --> 00:06:52,560
唯一的要考虑的是

179
00:06:52,560 --> 00:06:54,959
当你在卷机不能整除的时候

180
00:06:54,959 --> 00:06:56,519
那么你换过来是

181
00:06:56,519 --> 00:06:58,120
你许的输出n

182
00:06:58,480 --> 00:07:01,399
是对应的卷机最小的n

183
00:07:01,800 --> 00:07:03,519
使得能整除到一个n

184
00:07:04,839 --> 00:07:05,480
另外一块

185
00:07:05,480 --> 00:07:07,800
如果我们想让转制卷机

186
00:07:07,800 --> 00:07:10,680
让高宽成倍增加的情况下

187
00:07:10,879 --> 00:07:13,959
那么我们就要使得这项要等于0

188
00:07:14,399 --> 00:07:14,959
那么等于0

189
00:07:15,000 --> 00:07:17,880
就意味着k等于2p加上s

190
00:07:19,000 --> 00:07:19,840
那我回顾一下

191
00:07:19,840 --> 00:07:23,160
我们有在全连接卷机神经网络讲过

192
00:07:23,160 --> 00:07:27,120
我们是怎么样取p时的增大32倍的

193
00:07:27,240 --> 00:07:30,320
我们知道我们的窗口大小是64

194
00:07:30,760 --> 00:07:33,000
我们的不符取的是32

195
00:07:33,240 --> 00:07:34,080
所以这样子

196
00:07:34,080 --> 00:07:35,320
我们可以算出了我们的p

197
00:07:35,600 --> 00:07:37,400
就应该是等于16了

198
00:07:37,600 --> 00:07:39,280
这也是我们在FCN里面

199
00:07:39,280 --> 00:07:41,360
为什么p等于16的由来

200
00:07:42,360 --> 00:07:44,280
最后就是说

201
00:07:44,280 --> 00:07:45,480
大家有提问

202
00:07:45,480 --> 00:07:47,360
问到反卷机

203
00:07:48,160 --> 00:07:49,639
就是说数学上

204
00:07:49,639 --> 00:07:51,480
其实是有反卷机这个概念的

205
00:07:51,480 --> 00:07:52,680
叫做decommolution

206
00:07:52,879 --> 00:07:55,080
它指的是卷机的力运算

207
00:07:55,120 --> 00:07:58,439
就跟你负力变换和反负力变换

208
00:07:58,439 --> 00:07:59,759
是一个力运算一样

209
00:08:00,000 --> 00:08:01,080
所谓的力运算

210
00:08:01,080 --> 00:08:01,800
就是说

211
00:08:01,800 --> 00:08:06,080
假设我对输入x和k做卷机

212
00:08:06,120 --> 00:08:07,400
得到y的话

213
00:08:07,439 --> 00:08:08,680
那么反卷机

214
00:08:08,680 --> 00:08:11,080
就是说给定你y的值

215
00:08:11,400 --> 00:08:12,520
给定你的和

216
00:08:12,840 --> 00:08:14,280
它会得出你的x

217
00:08:14,280 --> 00:08:16,960
这里x和y是相互相等的关系

218
00:08:18,560 --> 00:08:20,160
但是转制卷机不一样

219
00:08:20,360 --> 00:08:21,439
转制卷机是说

220
00:08:21,439 --> 00:08:23,759
形状上是一个力运算

221
00:08:23,800 --> 00:08:26,000
但是从元素值上面不是的

222
00:08:26,199 --> 00:08:27,920
因为转制卷机

223
00:08:27,920 --> 00:08:29,360
本质上还是一种卷机

224
00:08:31,199 --> 00:08:34,560
反卷机很少被用在深度学习中间

225
00:08:35,600 --> 00:08:37,720
所以经常我们说的

226
00:08:38,039 --> 00:08:39,279
反卷机神级网络

227
00:08:39,279 --> 00:08:41,000
或者讲反卷机的情况下

228
00:08:41,000 --> 00:08:43,440
其实是有一点误解在里面

229
00:08:43,480 --> 00:08:45,559
我们所谓的反卷机神经网络

230
00:08:45,559 --> 00:08:46,759
其实是讲

231
00:08:46,759 --> 00:08:49,039
用了转制卷机的神经网络

232
00:08:49,240 --> 00:08:50,960
而并不是讲数学上的

233
00:08:50,960 --> 00:08:52,559
反卷机操作子

234
00:08:52,799 --> 00:08:54,440
所以大家要注意这一点

235
00:08:55,519 --> 00:08:55,960
OK

236
00:08:55,960 --> 00:08:56,919
最后总结一下

237
00:08:57,960 --> 00:09:00,360
我们从一个新的角度

238
00:09:01,000 --> 00:09:02,320
不一样的角度来说

239
00:09:02,360 --> 00:09:03,279
转制卷机

240
00:09:03,279 --> 00:09:04,720
其实就是一种卷机

241
00:09:05,120 --> 00:09:09,120
但是它把你变换了你的输入和和

242
00:09:09,200 --> 00:09:10,759
输入通常是说

243
00:09:10,759 --> 00:09:12,639
在里面加入了很多的零

244
00:09:12,639 --> 00:09:14,240
使得达到上采

245
00:09:14,399 --> 00:09:17,039
将你的输出的高宽变得更大的目的

246
00:09:17,279 --> 00:09:17,879
和的话

247
00:09:17,879 --> 00:09:19,840
我们做了一下反转

248
00:09:20,480 --> 00:09:22,319
另外一块转制卷机

249
00:09:22,439 --> 00:09:25,319
它不等同于数学上的反卷机操作

250
00:09:25,319 --> 00:09:26,720
就算你在神经网络说

251
00:09:26,720 --> 00:09:28,799
大家说这是一个反卷机神经网络

252
00:09:29,120 --> 00:09:30,360
其实你要知道

253
00:09:30,360 --> 00:09:32,480
它用的就是一个转制卷机

254
00:09:32,519 --> 00:09:35,319
其实本质上就是一个卷机神经网络

255
00:09:35,319 --> 00:09:37,039
只是对你的输入做了变换

256
00:09:37,039 --> 00:09:38,399
对你的和做了变换

