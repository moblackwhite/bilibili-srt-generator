1
00:00:00,000 --> 00:00:03,760
好,今天我们先讲的是全链接神经网络

2
00:00:03,760 --> 00:00:08,000
又叫Fully Connected Convolutional Neural Network

3
00:00:08,000 --> 00:00:10,800
简称叫FCN

4
00:00:12,800 --> 00:00:23,519
首先,全链接神经网络它是用深度学习来做语音分割的电击性的工作

5
00:00:23,519 --> 00:00:25,359
也就是最早的工作了

6
00:00:25,359 --> 00:00:28,719
所以意味着说它现在用的不多

7
00:00:29,039 --> 00:00:35,839
我们这里介绍主要是它确实思想上比较简单

8
00:00:35,839 --> 00:00:39,280
而且是开创新工作

9
00:00:39,280 --> 00:00:45,679
给大家怎么样用一个最简单的转制的卷迹层来实现我们要的结果

10
00:00:45,679 --> 00:00:48,320
当然现在的网络可能会更加复杂一点

11
00:00:48,320 --> 00:00:51,599
我们今天主要是讲这一个FCN网络

12
00:00:51,599 --> 00:00:54,399
首先这个网络其实挺简单的

13
00:00:54,399 --> 00:00:58,159
可以看到是一张slide我们就能讲完

14
00:00:58,880 --> 00:01:01,040
我们仔细看一下它是怎么做的

15
00:01:01,040 --> 00:01:08,880
它就是用一个转制的卷迹层来替换掉CN的最后的全链接神

16
00:01:08,880 --> 00:01:11,600
从而实现每个像素的预测

17
00:01:11,600 --> 00:01:13,600
我们来看一下是怎么做的

18
00:01:13,600 --> 00:01:18,400
首先你可以看到图片还是以前的图片

19
00:01:18,400 --> 00:01:25,040
然后这个CN你可以认为就是我们在ImageNet上pre-train好的一个CN的模型

20
00:01:25,200 --> 00:01:28,400
我们回忆一下ResNet也好什么样的模型也好

21
00:01:28,400 --> 00:01:32,960
然后我们知道我们的CN的模型最后的两层

22
00:01:32,960 --> 00:01:35,280
一般要么就是一个全链接层

23
00:01:35,280 --> 00:01:38,080
这样子能做到我的label的语音信息

24
00:01:38,719 --> 00:01:44,880
然后全链接层下面通常是一个全局的平均值划层

25
00:01:45,600 --> 00:01:49,520
这个地方全局的平均值划层就会把你的

26
00:01:49,520 --> 00:01:52,160
比如说我是24x24的图片

27
00:01:52,239 --> 00:01:55,359
然后过去之后会得到一个7x7的高宽

28
00:01:55,359 --> 00:01:59,359
全局的平均值划层我们知道就是把7x7变成一个1x1

29
00:01:59,359 --> 00:02:02,159
就是不管怎么样把整个通道里面做一个平均

30
00:02:02,159 --> 00:02:04,640
对于图片分类当然没问题

31
00:02:04,640 --> 00:02:10,079
但是对于我们需要空间信息来说这个东西就不是那么好了

32
00:02:10,960 --> 00:02:16,319
所以我们这个CN其实是去掉了最后的全链接层

33
00:02:16,319 --> 00:02:19,680
和你最后的全局平均值划层

34
00:02:20,400 --> 00:02:22,800
这样的话我们知道如果你是ImageNet

35
00:02:22,800 --> 00:02:24,960
是24x24的图片进去的话

36
00:02:24,960 --> 00:02:28,480
那么你的输出就是一个高宽是7x7的东西

37
00:02:28,960 --> 00:02:31,680
你的通道数可能是512x512

38
00:02:32,480 --> 00:02:36,879
然后拿到它之后我们这两个后面两个就是新的

39
00:02:36,879 --> 00:02:38,879
就是FCN新加的

40
00:02:38,879 --> 00:02:41,280
第一个是一个1x1的卷进程

41
00:02:41,760 --> 00:02:43,040
1x1卷进程是干嘛

42
00:02:43,040 --> 00:02:46,719
主要是用来它不会对空间信息做变化

43
00:02:46,719 --> 00:02:48,800
它主要是用来降你的维度的

44
00:02:48,880 --> 00:02:50,400
就把你的通道数降低

45
00:02:50,400 --> 00:02:54,400
就这里我们会我们等会代码会来看一下

46
00:02:54,400 --> 00:02:56,400
主要是来减低后面的计算量

47
00:02:57,439 --> 00:03:01,120
接下来就是一个转制的卷迹层

48
00:03:01,840 --> 00:03:04,560
我们知道就是我们昨天已经讲过了

49
00:03:04,560 --> 00:03:07,760
转制卷迹层就是把图片可以放大

50
00:03:08,320 --> 00:03:11,439
假设我们这个CN是把图片缩小的话

51
00:03:11,439 --> 00:03:14,960
一般来说如果是ImageNet的话会缩小32倍

52
00:03:14,960 --> 00:03:16,640
高宽都缩小32倍

53
00:03:17,200 --> 00:03:22,960
那么转制的卷迹层它就是把图片扩大32倍

54
00:03:23,680 --> 00:03:27,040
如果是224x24这里会变成一个7x7

55
00:03:27,040 --> 00:03:31,040
那么它就会把它还原成224x224

56
00:03:31,920 --> 00:03:34,080
它的通道数K是干嘛的呢

57
00:03:34,400 --> 00:03:38,160
它的K等于你的有多少类

58
00:03:38,560 --> 00:03:40,240
就是说对每一个像素

59
00:03:40,240 --> 00:03:41,840
这个里面的每一个像素

60
00:03:41,840 --> 00:03:45,520
它对每一个像素的类别的预测存在通道里面

61
00:03:46,080 --> 00:03:52,320
这个我们在网络中的网络和我们之后的目标检测

62
00:03:52,320 --> 00:03:54,719
也看到怎么样通道来存预测值

63
00:03:55,280 --> 00:03:58,719
所以这样子的话我们对一张图片

64
00:03:59,600 --> 00:04:01,600
不管是高宽是多少图片

65
00:04:01,600 --> 00:04:05,920
都会得到一个通道数为类别数的一个

66
00:04:05,920 --> 00:04:08,320
而且高宽是一样的一个预测

67
00:04:08,320 --> 00:04:13,200
这样子的话每一个像素我都能对它的做标号做预测了

68
00:04:13,600 --> 00:04:17,920
OK这就是AFCN的思想非常简单

69
00:04:18,319 --> 00:04:19,920
一页我们就讲完了

70
00:04:20,560 --> 00:04:22,160
接下来我们看一下它的实现

