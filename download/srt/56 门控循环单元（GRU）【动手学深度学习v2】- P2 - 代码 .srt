1
00:00:00,000 --> 00:00:03,320
我们首先讲的是叫做GRU

2
00:00:03,320 --> 00:00:05,799
叫做门控循环单元

3
00:00:06,719 --> 00:00:11,359
首先GRU它其实是最近几年提出来的

4
00:00:11,359 --> 00:00:16,440
它其实在我们接下来要讲的LSTM之后提出来的

5
00:00:16,719 --> 00:00:22,960
我们之所以先讲它是因为相对来说它比较简单一点

6
00:00:22,960 --> 00:00:26,400
所以LSTM其实还是挺复杂的一个网络

7
00:00:26,400 --> 00:00:28,760
所以我们先讲它

8
00:00:29,000 --> 00:00:30,880
然后过渡到LSTM

9
00:00:30,880 --> 00:00:34,000
然后从虽然它们之间长得不一样

10
00:00:34,200 --> 00:00:36,160
但是在效果上来讲

11
00:00:36,160 --> 00:00:38,600
其实这两个都差不多

12
00:00:39,120 --> 00:00:43,120
所以在实际中你可能用谁都差不多

13
00:00:43,120 --> 00:00:43,840
OK

14
00:00:44,520 --> 00:00:45,960
首先我们先讲GRU

15
00:00:46,240 --> 00:00:48,480
GRU这里面最重要的一点

16
00:00:48,480 --> 00:00:50,840
就是说我们要知道什么叫门控

17
00:00:50,840 --> 00:00:52,520
叫Gated这个东西

18
00:00:55,000 --> 00:00:57,640
我们在上节可以有讲过说

19
00:00:58,000 --> 00:00:59,240
做RN的时候

20
00:01:00,759 --> 00:01:03,079
你处理不了太长的序列

21
00:01:03,679 --> 00:01:05,760
这是因为你把整个序列信息

22
00:01:06,439 --> 00:01:09,560
全部放在你一个隐藏状态里面

23
00:01:09,960 --> 00:01:11,280
所有东西都放进去

24
00:01:11,400 --> 00:01:13,319
然后当你时间很长的时候

25
00:01:13,439 --> 00:01:17,280
你隐藏状态可能就累积了太多东西

26
00:01:17,319 --> 00:01:20,760
然后它对于前面很久以前的信息

27
00:01:20,920 --> 00:01:24,760
它可能就不那么好去从里面抽取出来了

28
00:01:25,760 --> 00:01:28,520
所以这个地方我们要观察到一个事情

29
00:01:28,520 --> 00:01:31,560
是说如果你观察到一个序列的话

30
00:01:31,600 --> 00:01:35,040
其实不是每个观察值都是同等重要

31
00:01:35,200 --> 00:01:37,120
比如说你看一只猫一只猫一只猫

32
00:01:37,120 --> 00:01:38,320
突然来一只老鼠

33
00:01:38,719 --> 00:01:40,160
然后再一只猫一只猫

34
00:01:40,280 --> 00:01:43,600
那么这个地方你看到是老鼠是一个很重要的事情

35
00:01:43,640 --> 00:01:45,800
毛第一次出现毛也很重要

36
00:01:46,120 --> 00:01:48,280
但是之后的毛就不那么重要了

37
00:01:48,680 --> 00:01:50,439
你在现实生活中

38
00:01:50,560 --> 00:01:51,719
你NLP里面

39
00:01:51,920 --> 00:01:53,040
把句子里面

40
00:01:53,280 --> 00:01:56,240
其实可能也就是一些关键字比较重要

41
00:01:56,520 --> 00:01:57,880
关键句比较重要

42
00:01:58,080 --> 00:02:00,200
别的地方其实可能也不那么重要

43
00:02:00,560 --> 00:02:01,920
如果同样的序列的话

44
00:02:02,160 --> 00:02:03,520
股票也是股票的话

45
00:02:03,520 --> 00:02:07,040
你其实重要的是那几个点

46
00:02:07,200 --> 00:02:10,240
比如说最近教育板块的股票狂跌

47
00:02:10,240 --> 00:02:10,960
比如说对吧

48
00:02:10,960 --> 00:02:12,280
这就是一个比较重要的点

49
00:02:12,560 --> 00:02:15,680
在很多时候股票就是在那么震荡而已

50
00:02:16,400 --> 00:02:17,840
电影的话也是一样的

51
00:02:17,840 --> 00:02:20,360
如果你出了一个video的视频的话

52
00:02:20,640 --> 00:02:22,280
其实针与针之间

53
00:02:22,719 --> 00:02:24,560
其实很多时候都是差不多的

54
00:02:24,560 --> 00:02:26,759
但是在切换场景的时候

55
00:02:27,520 --> 00:02:29,360
每次切换也是比较重要的

56
00:02:30,080 --> 00:02:32,000
所以就是说

57
00:02:32,400 --> 00:02:33,920
但是在我们之前的RN

58
00:02:34,080 --> 00:02:36,479
他没有这种机制让你去说

59
00:02:36,479 --> 00:02:39,080
我特别要关心某一些地方

60
00:02:39,080 --> 00:02:40,479
特别不关心某些地方

61
00:02:40,520 --> 00:02:42,920
对他来讲什么东西都是一个

62
00:02:42,920 --> 00:02:44,520
反正就是一个序列进去

63
00:02:45,280 --> 00:02:46,920
所以门控神经网络

64
00:02:47,000 --> 00:02:48,120
就Gate的那一块

65
00:02:48,439 --> 00:02:51,639
就是通过一些额外的控制单元

66
00:02:51,640 --> 00:02:55,560
使得我们在构造我们的状态

67
00:02:55,680 --> 00:02:56,680
隐藏状态的时候

68
00:02:57,600 --> 00:02:58,920
可以选择的去说

69
00:02:59,120 --> 00:02:59,920
这一块比较重要

70
00:02:59,920 --> 00:03:01,600
我看一看那一块不重要

71
00:03:01,600 --> 00:03:03,720
我可以可以忘记它

72
00:03:04,720 --> 00:03:08,080
所以但之后我们会讲注意力机制

73
00:03:08,080 --> 00:03:12,640
就是说更加去明更加的去刻画

74
00:03:12,640 --> 00:03:14,120
什么样去关注哪一块

75
00:03:14,120 --> 00:03:15,080
不关注哪一块

76
00:03:15,440 --> 00:03:15,880
OK

77
00:03:15,880 --> 00:03:17,160
所以我们先讲门

78
00:03:17,440 --> 00:03:19,880
门我们这里有两种门

79
00:03:19,880 --> 00:03:21,440
一种叫做更新门

80
00:03:21,439 --> 00:03:22,800
叫做update gate

81
00:03:23,240 --> 00:03:23,840
它是干嘛

82
00:03:23,919 --> 00:03:27,240
就是说它说这个数据比较重要

83
00:03:27,840 --> 00:03:30,800
我需要用它去尽量的去更新我的

84
00:03:30,800 --> 00:03:31,639
隐藏状态

85
00:03:32,599 --> 00:03:33,120
OK

86
00:03:33,120 --> 00:03:35,479
你就是说你把信息尽量的放到你的

87
00:03:35,479 --> 00:03:37,199
隐藏状态里面

88
00:03:37,199 --> 00:03:39,159
这样子你就能够交给后面

89
00:03:39,879 --> 00:03:41,719
另外一个叫做遗忘门

90
00:03:41,759 --> 00:03:43,000
或者叫重置门

91
00:03:43,680 --> 00:03:44,599
就是说重置门

92
00:03:44,599 --> 00:03:47,520
就是说这个东西到目前为止

93
00:03:47,520 --> 00:03:50,039
我觉得可能前面东西都不重要了

94
00:03:50,159 --> 00:03:50,239
好

95
00:03:50,239 --> 00:03:54,199
我就把我要么把输入给说输入不重要

96
00:03:54,199 --> 00:03:56,959
要么说我隐藏状态里面的东西

97
00:03:57,039 --> 00:03:59,280
我可以说忘掉一些东西

98
00:04:00,039 --> 00:04:00,319
好

99
00:04:00,319 --> 00:04:01,759
我们接下来具体看一下

100
00:04:01,759 --> 00:04:03,359
它是一个什么样的东西

101
00:04:05,840 --> 00:04:07,519
首先看一下什么是门

102
00:04:08,840 --> 00:04:09,879
门这个东西

103
00:04:09,879 --> 00:04:11,959
我们就是说通过公式和图

104
00:04:12,120 --> 00:04:14,319
这两个方面给大家来解释一下

105
00:04:14,639 --> 00:04:15,439
是怎么回事

106
00:04:16,439 --> 00:04:20,199
首先这里有张图

107
00:04:20,399 --> 00:04:23,120
这个图就表示了是一个层

108
00:04:23,680 --> 00:04:23,959
好

109
00:04:23,959 --> 00:04:24,920
你看一下我们这个层

110
00:04:25,319 --> 00:04:27,600
有一个输入XT

111
00:04:28,079 --> 00:04:30,279
然后有一个隐藏的状态

112
00:04:30,800 --> 00:04:32,399
是HT-E

113
00:04:32,800 --> 00:04:36,120
所以我们记得RN单元

114
00:04:36,480 --> 00:04:38,240
就是你的输入XT进来

115
00:04:38,240 --> 00:04:40,480
你的前一个时间的隐藏状态进来

116
00:04:40,560 --> 00:04:41,920
然后你要输出

117
00:04:42,240 --> 00:04:43,879
更新后的隐藏状态

118
00:04:44,040 --> 00:04:45,399
和你的输出

119
00:04:45,399 --> 00:04:46,519
就是那个YT

120
00:04:46,519 --> 00:04:46,959
对吧

121
00:04:47,759 --> 00:04:48,719
然后我们这个地方

122
00:04:48,879 --> 00:04:50,360
就是仔细的看说

123
00:04:50,600 --> 00:04:51,560
GIU这个门

124
00:04:51,959 --> 00:04:54,399
里面到底是在干什么事情

125
00:05:07,360 --> 00:05:08,519
把我的笔也拿过来

126
00:05:11,279 --> 00:05:11,759
行

127
00:05:11,920 --> 00:05:13,279
笔没有没关系

128
00:05:13,600 --> 00:05:14,280
首先看一下

129
00:05:14,280 --> 00:05:15,840
我们定义了两个门

130
00:05:15,840 --> 00:05:17,240
一个叫做RT

131
00:05:17,240 --> 00:05:18,320
一个叫ZT

132
00:05:18,680 --> 00:05:20,000
R就是重置

133
00:05:20,240 --> 00:05:22,040
Z就是更新

134
00:05:22,600 --> 00:05:23,640
然后我们看一下

135
00:05:23,640 --> 00:05:24,360
就是说

136
00:05:24,400 --> 00:05:26,040
首先门是个什么东西

137
00:05:26,480 --> 00:05:29,560
门其实它就是一根

138
00:05:30,000 --> 00:05:31,840
你可以认为跟隐藏状态

139
00:05:32,440 --> 00:05:35,600
同样长度是一样的一个向量

140
00:05:36,600 --> 00:05:38,760
它的计算方式

141
00:05:38,880 --> 00:05:39,920
跟我们计算

142
00:05:39,920 --> 00:05:42,640
我们之前RN的隐藏状态是一样的

143
00:05:42,839 --> 00:05:43,639
你可以看到

144
00:05:43,919 --> 00:05:45,439
RT是怎么算出来的

145
00:05:46,079 --> 00:05:47,639
你的XT进入它的

146
00:05:47,639 --> 00:05:49,759
R自己有W

147
00:05:49,759 --> 00:05:51,120
就是可以更新的权重

148
00:05:51,919 --> 00:05:53,719
WXT R我们积累

149
00:05:54,560 --> 00:05:56,159
加上HT-1

150
00:05:56,159 --> 00:05:57,599
就是上一刻时刻的隐藏状态

151
00:05:57,599 --> 00:05:59,399
产生它对应的矩阵

152
00:06:00,199 --> 00:06:01,639
再加上你的BIOS

153
00:06:02,159 --> 00:06:03,479
做一个SIGMA

154
00:06:03,479 --> 00:06:05,759
SIGMA就是一个SIGMOID的一个

155
00:06:05,879 --> 00:06:06,240
函数

156
00:06:06,240 --> 00:06:07,360
就是说把所有东西

157
00:06:07,560 --> 00:06:08,879
变到0和1之间

158
00:06:09,399 --> 00:06:11,199
更新函数得到RT

159
00:06:11,560 --> 00:06:12,560
所以这个东西是什么

160
00:06:12,560 --> 00:06:13,439
这个东西说白了

161
00:06:15,680 --> 00:06:16,920
如果你是RN的话

162
00:06:16,920 --> 00:06:17,519
它说白了

163
00:06:17,519 --> 00:06:18,879
就是等价以一个

164
00:06:19,240 --> 00:06:20,600
使用SIGMOID的

165
00:06:20,600 --> 00:06:22,079
作为计划函数的

166
00:06:22,560 --> 00:06:23,600
对应的隐藏状态

167
00:06:23,600 --> 00:06:24,560
是怎么计算的

168
00:06:25,720 --> 00:06:26,240
OK

169
00:06:27,319 --> 00:06:28,480
接下来就是说

170
00:06:28,680 --> 00:06:29,680
你看一下Z

171
00:06:30,680 --> 00:06:31,920
ZT是一样的

172
00:06:31,920 --> 00:06:33,319
就是它另外一个门

173
00:06:33,680 --> 00:06:36,720
它也是跟你算隐藏状态

174
00:06:36,720 --> 00:06:38,680
和你RT是算起来是一样的

175
00:06:39,240 --> 00:06:40,199
只是不一样的是说

176
00:06:40,199 --> 00:06:41,120
你对于Z

177
00:06:41,639 --> 00:06:42,920
你也有自己的权重

178
00:06:42,920 --> 00:06:43,560
就是W

179
00:06:43,840 --> 00:06:45,000
这个W两个W

180
00:06:45,000 --> 00:06:46,120
再加上一个BIOS

181
00:06:47,959 --> 00:06:48,480
OK

182
00:06:48,480 --> 00:06:50,280
所以这个就是我们的

183
00:06:50,439 --> 00:06:51,840
额外算的两个门

184
00:06:51,840 --> 00:06:53,600
所以跟你之前比

185
00:06:53,720 --> 00:06:54,600
就等价于是说

186
00:06:54,600 --> 00:06:57,199
我的又多了那么几个权重

187
00:06:57,360 --> 00:06:59,120
可以学习的权重

188
00:06:59,120 --> 00:07:00,120
加上你的偏移

189
00:07:00,319 --> 00:07:01,280
然后它计算

190
00:07:01,280 --> 00:07:02,360
就是我们算的这个地方

191
00:07:02,360 --> 00:07:03,079
你可以看一下

192
00:07:03,120 --> 00:07:06,319
就说HT-1进来

193
00:07:06,840 --> 00:07:08,439
XT进来

194
00:07:08,439 --> 00:07:09,399
进到这个地方

195
00:07:09,439 --> 00:07:10,600
然后SIGMA一下

196
00:07:10,760 --> 00:07:11,520
其实就说白了

197
00:07:11,520 --> 00:07:13,040
就是一个全连接层

198
00:07:13,480 --> 00:07:15,360
这东西就是等价一个全连接层

199
00:07:15,640 --> 00:07:16,439
然后就等价

200
00:07:16,439 --> 00:07:18,480
就是把这两个concat起来

201
00:07:18,480 --> 00:07:19,439
就并在一起

202
00:07:19,439 --> 00:07:20,760
放到一个全连接层

203
00:07:20,760 --> 00:07:21,680
这个全连接层

204
00:07:21,840 --> 00:07:23,600
用SIGMA作为激活函数

205
00:07:23,800 --> 00:07:24,800
得到我的输出

206
00:07:25,120 --> 00:07:25,840
从而道理的话

207
00:07:25,840 --> 00:07:26,960
我也是复制一遍

208
00:07:26,960 --> 00:07:28,560
我出来得到我的输出

209
00:07:29,320 --> 00:07:31,080
所以那个RR叫做

210
00:07:31,439 --> 00:07:33,200
Reset Gate

211
00:07:33,680 --> 00:07:35,680
就是用来重置用的

212
00:07:36,000 --> 00:07:38,560
Z就控制的是Update Gate

213
00:07:38,879 --> 00:07:39,639
我们接下来看一看

214
00:07:39,639 --> 00:07:42,120
它是在干什么事情

215
00:07:44,519 --> 00:07:46,560
接下来有一个东西

216
00:07:46,560 --> 00:07:49,959
叫做候选隐藏状态

217
00:07:50,920 --> 00:07:52,560
就它不是真正的隐藏状态

218
00:07:52,560 --> 00:07:53,519
它是候选的

219
00:07:53,519 --> 00:07:54,759
就是说用它来声称

220
00:07:54,759 --> 00:07:56,360
我们真正的要的隐藏状态

221
00:07:56,720 --> 00:07:58,160
可以看一下是怎么回事

222
00:07:58,959 --> 00:08:02,600
首先假设你不去看这个RRT的话

223
00:08:02,920 --> 00:08:03,519
说白了

224
00:08:03,519 --> 00:08:06,199
它就是我们之前RN是怎么算

225
00:08:06,199 --> 00:08:07,160
隐藏状态的

226
00:08:07,480 --> 00:08:09,160
就是XT进来

227
00:08:09,360 --> 00:08:10,800
它对应的隐藏状态

228
00:08:10,800 --> 00:08:11,720
对应的W

229
00:08:12,160 --> 00:08:13,520
再加上假设你不看R

230
00:08:14,200 --> 00:08:16,480
假设你上一个时刻的隐藏状态

231
00:08:16,480 --> 00:08:17,439
乘以你的权重

232
00:08:17,439 --> 00:08:18,400
再加上你的B

233
00:08:18,520 --> 00:08:20,760
用一个TimeH作为激活函数

234
00:08:20,840 --> 00:08:21,560
这个就是说

235
00:08:21,560 --> 00:08:22,840
假设你不看R的话

236
00:08:22,880 --> 00:08:25,120
那就是我们之前RN

237
00:08:25,120 --> 00:08:26,960
是怎么样计算隐藏状态的

238
00:08:28,400 --> 00:08:29,440
但是现在

239
00:08:30,280 --> 00:08:32,120
我们加了一个R在这里

240
00:08:33,120 --> 00:08:34,360
这个点

241
00:08:36,360 --> 00:08:40,519
全是一个按元素乘法的意思

242
00:08:41,080 --> 00:08:42,720
我们知道我们这个RT

243
00:08:43,200 --> 00:08:44,240
它那个门

244
00:08:44,399 --> 00:08:46,360
它是一个跟你的HT是一个

245
00:08:46,360 --> 00:08:47,799
长为一样的一个

246
00:08:48,519 --> 00:08:49,200
向量

247
00:08:49,200 --> 00:08:51,080
就对一个样本来就它是一个向量

248
00:08:51,399 --> 00:08:53,639
它的长度就是你的Hidden Size

249
00:08:55,320 --> 00:08:56,399
所以它这可以

250
00:08:56,399 --> 00:08:58,120
因为这两个东西长度是一样的

251
00:08:58,120 --> 00:09:00,759
所以你可以按元素做乘法

252
00:09:01,200 --> 00:09:02,080
然后另外一块

253
00:09:02,080 --> 00:09:04,080
我知道这个东西是一个0到1之间的

254
00:09:04,080 --> 00:09:04,279
值

255
00:09:04,279 --> 00:09:05,840
因为你用的是一个Mod对吧

256
00:09:06,360 --> 00:09:08,399
所以这个意思什么意思

257
00:09:08,919 --> 00:09:13,000
假设我里面的元素靠近0的话

258
00:09:13,759 --> 00:09:15,080
那么这一个东西乘出来

259
00:09:16,480 --> 00:09:18,879
它就会变得像0

260
00:09:19,799 --> 00:09:21,360
它变得像0是什么意思

261
00:09:21,439 --> 00:09:22,879
就是说你变像0

262
00:09:22,879 --> 00:09:25,200
就是说我等于是把上一个时刻的

263
00:09:25,200 --> 00:09:28,039
隐藏状态给你忘掉

264
00:09:28,960 --> 00:09:29,879
就设成0了

265
00:09:29,879 --> 00:09:30,840
就上一个就是说

266
00:09:30,840 --> 00:09:33,080
你有值表示你有状态

267
00:09:33,279 --> 00:09:33,960
我设成0

268
00:09:34,080 --> 00:09:35,279
就表示什么都没有了

269
00:09:35,279 --> 00:09:35,679
对吧

270
00:09:35,679 --> 00:09:36,759
如果全部设成0

271
00:09:36,759 --> 00:09:38,279
就变成了初始状态了

272
00:09:39,120 --> 00:09:40,120
极端情况

273
00:09:40,120 --> 00:09:41,960
RT全部等于0

274
00:09:41,960 --> 00:09:43,639
那等于是说这个时刻开始

275
00:09:43,639 --> 00:09:45,360
我前面的信息全部不要

276
00:09:45,600 --> 00:09:46,840
我的隐藏状态

277
00:09:47,000 --> 00:09:49,080
变成0初始化开始

278
00:09:50,519 --> 00:09:51,639
另外一个极端情况

279
00:09:51,639 --> 00:09:53,159
就是RT里面全是1

280
00:09:53,919 --> 00:09:56,320
那么就表示我就是所有前面的信息

281
00:09:56,320 --> 00:09:58,840
全部拿过来做当前的更新

282
00:09:58,840 --> 00:09:59,879
就等价于回了

283
00:09:59,879 --> 00:10:02,120
我的RN是怎么样算隐藏状态的

284
00:10:02,639 --> 00:10:03,759
当然实际上来说

285
00:10:03,879 --> 00:10:05,840
因为它RT是可以学的

286
00:10:06,000 --> 00:10:08,840
所以它会去根据你前面的东西来学

287
00:10:08,840 --> 00:10:10,240
说看到这个情况

288
00:10:10,240 --> 00:10:11,560
我觉得哪一些东西

289
00:10:11,560 --> 00:10:13,480
我应该过

290
00:10:14,360 --> 00:10:16,680
pass到下一轮的隐藏状态

291
00:10:16,840 --> 00:10:17,720
哪一轮东西

292
00:10:17,840 --> 00:10:18,600
就前面的东西

293
00:10:18,720 --> 00:10:20,080
哪一些东西我就不要了

294
00:10:20,280 --> 00:10:22,560
然后我可以自动去干这个事情

295
00:10:22,600 --> 00:10:24,480
它所以是一个控制单元

296
00:10:24,639 --> 00:10:26,120
所以它有点像

297
00:10:26,120 --> 00:10:26,960
所以叫门

298
00:10:27,160 --> 00:10:28,720
门其实是电路里面的概念

299
00:10:28,840 --> 00:10:29,800
门就是说

300
00:10:29,800 --> 00:10:31,320
电路说我这个门有可以

301
00:10:31,440 --> 00:10:32,320
你可以过去

302
00:10:32,320 --> 00:10:32,920
可以不过去

303
00:10:32,920 --> 00:10:34,920
就要么是阻挡住你

304
00:10:35,120 --> 00:10:36,000
要么是通过

305
00:10:36,560 --> 00:10:38,840
但是这个地方我们是一个软的

306
00:10:38,960 --> 00:10:40,360
因为它是0到1的

307
00:10:40,480 --> 00:10:42,680
然后所以就表示说

308
00:10:42,680 --> 00:10:46,280
它里面是可以做0到1之间

309
00:10:46,280 --> 00:10:48,080
可以做比较软的控制的样子

310
00:10:49,720 --> 00:10:50,320
OK

311
00:10:50,920 --> 00:10:51,160
好

312
00:10:51,160 --> 00:10:52,639
我们接下来再来看一下

313
00:10:52,639 --> 00:10:54,960
我的隐状态是怎么样子

314
00:10:54,960 --> 00:10:56,519
就我真正的隐状态

315
00:10:56,519 --> 00:11:00,399
真正的隐状态是

316
00:11:01,720 --> 00:11:07,919
ZT按元素点成上一次的隐藏状态

317
00:11:08,240 --> 00:11:11,679
加上1-ZT点成按元素

318
00:11:11,679 --> 00:11:13,840
点成我的后旋隐藏状态

319
00:11:15,360 --> 00:11:15,679
好

320
00:11:15,679 --> 00:11:18,600
Z这个地方又是一个控制单元

321
00:11:18,600 --> 00:11:20,360
叫做update gate

322
00:11:21,439 --> 00:11:22,039
就我们看一下

323
00:11:22,039 --> 00:11:22,840
就是说我们知道

324
00:11:22,840 --> 00:11:25,399
它也是在0到1之间的一些数字

325
00:11:26,360 --> 00:11:29,439
假设ZT它都等于1

326
00:11:29,439 --> 00:11:30,039
是什么意思

327
00:11:30,600 --> 00:11:32,399
等于1的意思是说

328
00:11:32,759 --> 00:11:34,039
那么这个地方就是

329
00:11:34,039 --> 00:11:36,399
HT就等于HT-1了

330
00:11:37,879 --> 00:11:38,799
不更新

331
00:11:39,199 --> 00:11:39,720
等于是说

332
00:11:39,720 --> 00:11:42,720
我就把我不更新过去的状态

333
00:11:42,720 --> 00:11:46,600
我就把过去状态直接放成现在

334
00:11:46,959 --> 00:11:49,039
等于是我这个XT我就不要了

335
00:11:49,039 --> 00:11:52,639
就是不要用XT来更新我的隐藏状态

336
00:11:52,639 --> 00:11:55,039
等于是我忽略掉了这一个元素

337
00:11:56,399 --> 00:12:00,399
假设你的ZT几乎等于0的时候

338
00:12:00,399 --> 00:12:01,039
会怎么样

339
00:12:01,720 --> 00:12:02,759
等于0的时候

340
00:12:04,000 --> 00:12:06,799
基本上就回到了我们RN的情况

341
00:12:06,799 --> 00:12:10,720
就是说我就不去直接拉过去的状态了

342
00:12:10,720 --> 00:12:14,439
我基本上去看我现在的更新的状态

343
00:12:14,879 --> 00:12:15,399
OK

344
00:12:15,399 --> 00:12:16,600
所以在这种情况下

345
00:12:16,720 --> 00:12:17,840
你的ZT等于0

346
00:12:17,879 --> 00:12:20,199
然后你的reset gate

347
00:12:20,439 --> 00:12:22,159
也是没有作用的时候

348
00:12:22,159 --> 00:12:24,279
它就等价回你的RN

349
00:12:24,839 --> 00:12:27,079
但是在一般情况下

350
00:12:27,279 --> 00:12:29,759
这两个就reset gate R

351
00:12:29,959 --> 00:12:32,120
这个Z是能控制说

352
00:12:32,120 --> 00:12:36,159
你要么是我就丢掉当前的XT

353
00:12:36,439 --> 00:12:37,279
直接回去

354
00:12:37,279 --> 00:12:39,839
或者是说我在这里面进来的时候

355
00:12:40,439 --> 00:12:43,120
这个新的状态进来的时候

356
00:12:43,600 --> 00:12:46,759
是用多少过去的状态

357
00:12:47,399 --> 00:12:50,480
加上现在的XT来做计算的

358
00:12:51,720 --> 00:12:52,679
所以总结一下

359
00:12:53,680 --> 00:12:56,840
这个就是GRU

360
00:12:57,560 --> 00:13:01,640
GRU我们引入了两个额外的门

361
00:13:01,960 --> 00:13:04,520
每个门它可以学的参数

362
00:13:04,640 --> 00:13:07,520
就跟我们之前的RN是一样多的

363
00:13:08,360 --> 00:13:11,040
然后这些权重WXR

364
00:13:11,040 --> 00:13:13,520
XZ XH

365
00:13:13,640 --> 00:13:14,880
它都是长的是

366
00:13:14,920 --> 00:13:15,960
形状都是一样的

367
00:13:15,960 --> 00:13:16,960
科学的权重

368
00:13:17,560 --> 00:13:20,320
所以等于是说我们的科学学的权重

369
00:13:20,320 --> 00:13:21,640
应该是多了两倍

370
00:13:22,000 --> 00:13:22,919
是以前的三倍

371
00:13:22,919 --> 00:13:24,159
是以前RN的三倍

372
00:13:24,919 --> 00:13:27,480
然后这两个门就是一个控制单元

373
00:13:27,480 --> 00:13:30,480
因为它都是输出0到1之间的一些数值

374
00:13:31,399 --> 00:13:33,279
它一个是用来reset

375
00:13:33,279 --> 00:13:34,199
是用来说

376
00:13:34,199 --> 00:13:36,639
我在更新我的新隐藏状态的时候

377
00:13:37,439 --> 00:13:41,199
要用到多少过去的隐藏状态的信息

378
00:13:42,480 --> 00:13:43,639
另外一个是说

379
00:13:43,639 --> 00:13:46,600
在算我真正的新的隐藏状态的时候

380
00:13:46,920 --> 00:13:52,600
我是需要用当前新的关于XT相关的信息

381
00:13:52,600 --> 00:13:53,440
要多少信息

382
00:13:55,080 --> 00:13:57,120
极端情况一个是说

383
00:13:57,120 --> 00:13:59,600
你的Z等于0

384
00:13:59,720 --> 00:14:01,200
然后R等于1

385
00:14:01,680 --> 00:14:02,960
就是说Z里面全0

386
00:14:03,000 --> 00:14:04,200
R里面全1的时候

387
00:14:04,560 --> 00:14:07,600
就会回到我们之前的RN的情况

388
00:14:07,879 --> 00:14:08,879
说白了就是

389
00:14:08,879 --> 00:14:11,720
HT等于H的那个T

390
00:14:12,639 --> 00:14:14,000
然后R是等于

391
00:14:14,000 --> 00:14:16,480
所以这就是我们之前RN是怎么算的

392
00:14:17,040 --> 00:14:18,560
另外一些极端情况

393
00:14:19,320 --> 00:14:21,200
我就是完全不看XT

394
00:14:21,879 --> 00:14:26,639
然后直接从HT-1等于HT

395
00:14:26,639 --> 00:14:27,639
就是直接

396
00:14:29,120 --> 00:14:30,840
基本忽略到当前XT

397
00:14:31,440 --> 00:14:33,200
另外一个状态就是说

398
00:14:33,480 --> 00:14:35,759
我在算我的获取状态的时候

399
00:14:36,320 --> 00:14:37,600
整个新的状态

400
00:14:38,040 --> 00:14:39,639
只跟XT相关

401
00:14:40,080 --> 00:14:42,120
就不需要用到前面的所有信息

402
00:14:42,120 --> 00:14:44,840
就直接HT是从XT过去的

403
00:14:45,879 --> 00:14:46,440
OK

404
00:14:46,920 --> 00:14:48,279
就是说基本上就是说

405
00:14:48,320 --> 00:14:49,399
要么就是

406
00:14:50,120 --> 00:14:51,440
不看一个极端

407
00:14:51,440 --> 00:14:52,920
就是说不看XT

408
00:14:52,920 --> 00:14:54,360
就是忽略到它

409
00:14:54,399 --> 00:14:55,879
另外一个极端情况就是

410
00:14:55,879 --> 00:14:57,159
我只看XT

411
00:14:57,159 --> 00:14:58,759
前面的信息我都不管了

412
00:14:58,759 --> 00:14:59,800
只看当下

413
00:14:59,840 --> 00:15:00,240
OK

414
00:15:00,240 --> 00:15:03,399
这就是GRU这样子新引进的

415
00:15:03,399 --> 00:15:05,080
两个极端的情况

416
00:15:05,200 --> 00:15:05,759
是的

417
00:15:05,759 --> 00:15:08,320
然后它通常是在这两个极端情况之间

418
00:15:08,440 --> 00:15:11,200
做一些可以学的一些调整

419
00:15:11,240 --> 00:15:13,519
使得你可以去控制说

420
00:15:13,519 --> 00:15:14,519
我到底是

421
00:15:15,519 --> 00:15:17,240
多去看现在的XT

422
00:15:17,519 --> 00:15:19,519
还是说我就不少看它

423
00:15:19,519 --> 00:15:21,639
然后尽量去看一下过去的信息

