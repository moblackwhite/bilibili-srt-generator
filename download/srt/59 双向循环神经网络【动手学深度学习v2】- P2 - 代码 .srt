1
00:00:00,000 --> 00:00:02,600
就是说双向循环行行网络

2
00:00:02,600 --> 00:00:05,600
我们之前在讲序列模型的时候有讲过说

3
00:00:05,600 --> 00:00:08,199
你可以往前从前往后看

4
00:00:08,199 --> 00:00:10,000
你也可以从后往前看对吧

5
00:00:10,000 --> 00:00:11,800
在某些情况下是可以的

6
00:00:11,800 --> 00:00:13,200
某些情况当然是不行的

7
00:00:13,200 --> 00:00:16,600
我们来看一下是怎么样做的

8
00:00:17,600 --> 00:00:18,600
首先看一个例子

9
00:00:18,600 --> 00:00:22,199
就是说你说我要你填一句话叫I am什么什么

10
00:00:22,199 --> 00:00:24,600
然后说我跟你然后变成完全体控

11
00:00:24,600 --> 00:00:26,600
我非常饿

12
00:00:26,600 --> 00:00:27,600
我非常饿

13
00:00:27,600 --> 00:00:31,200
我能够吃下一头猪

14
00:00:31,200 --> 00:00:32,600
半头猪

15
00:00:32,600 --> 00:00:33,800
所以那么填

16
00:00:33,800 --> 00:00:34,800
填空的话

17
00:00:34,800 --> 00:00:36,600
你I am那就随便选了

18
00:00:36,600 --> 00:00:37,600
就I am happy

19
00:00:37,600 --> 00:00:40,200
就是说这个是很会很sad

20
00:00:40,200 --> 00:00:43,000
就Very hungry说你可以

21
00:00:43,000 --> 00:00:44,400
Not very都可以

22
00:00:44,400 --> 00:00:45,600
就我可以随便填

23
00:00:45,600 --> 00:00:48,000
但如果你在给定后面的句子的话

24
00:00:48,000 --> 00:00:49,000
我那么填空的话

25
00:00:49,000 --> 00:00:50,600
就会根据是very了

26
00:00:50,600 --> 00:00:51,799
对吧

27
00:00:51,799 --> 00:00:54,600
所以核心的意思是说

28
00:00:54,600 --> 00:00:57,399
你根据你的后面的文本的关系

29
00:00:57,399 --> 00:01:01,399
可以让你取决于前面怎么做的

30
00:01:01,399 --> 00:01:02,600
所以核心这样是说

31
00:01:02,600 --> 00:01:05,599
取决于过去和未来的剩下文

32
00:01:05,599 --> 00:01:07,799
你可以很填不一样的词

33
00:01:07,799 --> 00:01:10,599
目前来看我们RNN只看过去

34
00:01:10,599 --> 00:01:12,799
所以假设我让我预测下一个词的话

35
00:01:12,799 --> 00:01:14,799
我的RNN只是看I am

36
00:01:14,799 --> 00:01:16,000
那么只看到这两个词的话

37
00:01:16,000 --> 00:01:17,599
我当然就不知道怎么做了

38
00:01:17,599 --> 00:01:19,200
如果我能看到后面的话

39
00:01:19,200 --> 00:01:22,400
那当然我在完形填空的时候是有用的

40
00:01:23,400 --> 00:01:24,600
OK

41
00:01:24,600 --> 00:01:27,600
所以双向神经网络是什么意思呢

42
00:01:29,800 --> 00:01:32,800
双向神经网络的意思是说

43
00:01:32,800 --> 00:01:34,600
我的一个隐藏层

44
00:01:34,600 --> 00:01:37,400
其实是有两个

45
00:01:38,800 --> 00:01:39,600
OK

46
00:01:39,600 --> 00:01:41,600
然后它是怎么做

47
00:01:41,600 --> 00:01:43,400
它是首先是

48
00:01:44,200 --> 00:01:46,400
首先是我的输入进来

49
00:01:46,800 --> 00:01:47,800
进来的话

50
00:01:49,800 --> 00:01:51,400
比如说进来的话

51
00:01:51,400 --> 00:01:52,800
我要两个一个是这个箭头

52
00:01:52,800 --> 00:01:54,000
一个是往前的箭头

53
00:01:54,000 --> 00:01:55,200
一个是往后的箭头

54
00:01:55,200 --> 00:01:56,400
往前的箭头

55
00:01:56,400 --> 00:01:58,400
意思是我的输入进来

56
00:01:58,400 --> 00:02:02,000
我的state是放到下一个

57
00:02:02,600 --> 00:02:04,200
它的输入进去

58
00:02:06,200 --> 00:02:06,600
OK

59
00:02:06,600 --> 00:02:07,800
然后这是正常

60
00:02:08,200 --> 00:02:09,800
反过来是怎么做

61
00:02:10,200 --> 00:02:11,800
反过来是说

62
00:02:12,400 --> 00:02:15,800
XR它输入到这个地方

63
00:02:15,800 --> 00:02:17,800
它更新后隐藏状态的时候

64
00:02:17,800 --> 00:02:20,400
是去给X1用的

65
00:02:21,200 --> 00:02:23,599
最后这两个东西的隐藏状态

66
00:02:24,000 --> 00:02:25,599
把它合在一起

67
00:02:25,800 --> 00:02:26,800
就本来是256

68
00:02:27,000 --> 00:02:29,200
现在就合成了512

69
00:02:29,599 --> 00:02:30,599
然后丢出去

70
00:02:33,000 --> 00:02:34,400
实现上怎么实现

71
00:02:34,400 --> 00:02:35,800
实现上其实挺简单的

72
00:02:35,800 --> 00:02:36,800
实现上怎么实现

73
00:02:38,800 --> 00:02:41,599
你就是把还是一个东西

74
00:02:41,800 --> 00:02:44,599
你就把序列反一下就行了

75
00:02:44,599 --> 00:02:45,000
对吧

76
00:02:46,000 --> 00:02:46,599
就是说

77
00:02:48,000 --> 00:02:49,800
假设你的实现是这个顺序的话

78
00:02:49,800 --> 00:02:51,600
是从前往后的话

79
00:02:51,600 --> 00:02:53,400
那么我要实现一个反向怎么反向

80
00:02:53,400 --> 00:02:54,800
我就把我这个序列反过来

81
00:02:54,800 --> 00:02:56,600
然后丢进去不就完事了吗

82
00:02:56,600 --> 00:02:57,800
就可以得到那个东西了

83
00:02:57,800 --> 00:02:58,200
对吧

84
00:02:58,400 --> 00:02:59,800
当然是你输出的时候

85
00:02:59,800 --> 00:03:01,400
我还得跟着反一下

86
00:03:01,400 --> 00:03:01,800
对吧

87
00:03:02,000 --> 00:03:04,400
就我把就这一层的实现

88
00:03:04,600 --> 00:03:06,800
这层时间就是把输入反向

89
00:03:07,000 --> 00:03:08,600
输出拿到输出

90
00:03:08,600 --> 00:03:10,200
然后把输出再返回来

91
00:03:10,800 --> 00:03:12,200
OK就完事了

92
00:03:12,200 --> 00:03:14,600
然后再跟下一个做空开的就行了

93
00:03:14,800 --> 00:03:17,000
那么具体看一下

94
00:03:17,000 --> 00:03:19,000
就是说其实也一样

95
00:03:19,599 --> 00:03:20,800
但你公式上来写

96
00:03:20,800 --> 00:03:22,800
你就说你前项是这么前项的

97
00:03:22,800 --> 00:03:25,400
反向就是说你XT是由

98
00:03:25,400 --> 00:03:27,000
HT是由

99
00:03:27,199 --> 00:03:29,599
HT加1的状态过来的

100
00:03:30,800 --> 00:03:31,400
OK

101
00:03:32,599 --> 00:03:34,000
然后这是公式写法的

102
00:03:34,000 --> 00:03:35,000
实际写法就反一下

103
00:03:35,000 --> 00:03:35,400
对吧

104
00:03:35,400 --> 00:03:38,199
然后最后是两个东西空开了起来

105
00:03:38,199 --> 00:03:40,000
然后进入你的输出层

106
00:03:43,199 --> 00:03:43,800
OK

107
00:03:45,000 --> 00:03:48,000
所以基本就是这个意思

108
00:03:48,000 --> 00:03:52,199
就是我们不会给大家讲具体怎么实现

109
00:03:52,199 --> 00:03:54,599
就是说给大家就是说稍微讲一下

110
00:03:54,599 --> 00:03:57,400
就是你的实现

111
00:03:57,400 --> 00:03:59,400
就是一个东西

112
00:03:59,400 --> 00:04:01,199
一个之前我们写完代码

113
00:04:01,199 --> 00:04:03,599
把输入复制一遍

114
00:04:03,599 --> 00:04:05,199
然后做4的时候

115
00:04:05,400 --> 00:04:09,400
把我的第一个隐藏层就是正常出来

116
00:04:09,400 --> 00:04:10,800
就出一堆那个output

117
00:04:10,800 --> 00:04:11,199
是吧

118
00:04:11,400 --> 00:04:12,199
然后出一堆

119
00:04:12,199 --> 00:04:16,800
然后第二个隐藏层就是把输入给你反一下

120
00:04:16,800 --> 00:04:18,800
放进去把输出再反一下

121
00:04:18,800 --> 00:04:23,600
然后输出跟前面的输出一一对应的去做空开了起来

122
00:04:23,600 --> 00:04:25,600
然后再丢回到最后一层

123
00:04:26,800 --> 00:04:27,199
OK

124
00:04:27,199 --> 00:04:30,000
这就是双向的RN的实现

125
00:04:30,400 --> 00:04:32,400
这样子我们就可以达到说

126
00:04:32,400 --> 00:04:35,800
这一条path就是是往前看的

127
00:04:35,800 --> 00:04:37,000
就这个方向看的

128
00:04:37,000 --> 00:04:38,800
后面他把时候往后看的

129
00:04:38,800 --> 00:04:40,000
然后对每一个token

130
00:04:40,000 --> 00:04:42,000
就任何一个token

131
00:04:42,000 --> 00:04:44,199
我这个地方拿到的H是

132
00:04:44,199 --> 00:04:46,199
这边的信息过来

133
00:04:46,399 --> 00:04:48,199
这边的H是这个东西信息过来

134
00:04:48,199 --> 00:04:48,599
对吧

135
00:04:48,599 --> 00:04:51,199
所以我任何一个中间token

136
00:04:51,199 --> 00:04:53,399
它是两个方向的信息

137
00:04:53,399 --> 00:04:55,599
在这个地方同时出现出去了

138
00:04:56,000 --> 00:04:56,599
OK

139
00:04:58,000 --> 00:04:58,399
好

140
00:04:58,399 --> 00:04:59,800
训练的时候就是说

141
00:04:59,800 --> 00:05:01,599
这个训练时候比较容易

142
00:05:01,599 --> 00:05:02,000
对吧

143
00:05:02,000 --> 00:05:03,719
假设你要做RN的话

144
00:05:03,719 --> 00:05:04,800
训练时候就是

145
00:05:04,800 --> 00:05:06,519
你把后面的东西拿过来

146
00:05:06,519 --> 00:05:07,599
前面东西拿过去

147
00:05:07,599 --> 00:05:10,199
但是问题是这个东西做推理不好推理

148
00:05:11,199 --> 00:05:14,120
所以双向神经网做推理怎么推理

149
00:05:14,120 --> 00:05:14,839
推理的话

150
00:05:14,840 --> 00:05:17,120
也就是说我说我给你两个东西

151
00:05:17,120 --> 00:05:18,640
然后去推理下一个

152
00:05:19,240 --> 00:05:20,560
加上你训练的时候不行

153
00:05:20,760 --> 00:05:22,080
因为你这个东西会有问题

154
00:05:22,080 --> 00:05:22,360
对吧

155
00:05:22,360 --> 00:05:24,120
我看不到未来

156
00:05:24,120 --> 00:05:24,960
我看不到

157
00:05:25,640 --> 00:05:26,160
对吧

158
00:05:26,280 --> 00:05:27,040
就是说

159
00:05:27,240 --> 00:05:29,480
双向LSTM

160
00:05:30,160 --> 00:05:31,600
非常不适合做推理

161
00:05:32,520 --> 00:05:33,640
不能用在

162
00:05:33,760 --> 00:05:37,240
几乎是不能用在去预测下一个词上面

163
00:05:38,480 --> 00:05:38,840
OK

164
00:05:38,840 --> 00:05:41,320
是因为你在你为了得到

165
00:05:41,320 --> 00:05:43,440
因为对它做输出的那个H

166
00:05:43,600 --> 00:05:45,439
需要既看到之前的信息

167
00:05:45,439 --> 00:05:50,199
又看到它之后和它之后的信息

168
00:05:50,360 --> 00:05:51,399
所以在这个情况下

169
00:05:51,399 --> 00:05:52,920
你在推理的时候没有之后的信息

170
00:05:52,920 --> 00:05:54,199
你是做不了推理的

171
00:05:54,399 --> 00:05:56,240
所以在双向

172
00:05:57,480 --> 00:05:58,639
循环神经网络

173
00:05:58,680 --> 00:06:01,800
主要的作用是对一个句子

174
00:06:02,040 --> 00:06:03,360
做特征提取

175
00:06:04,399 --> 00:06:06,600
比如在语义在做翻译的时候

176
00:06:07,360 --> 00:06:08,879
我给另一个句子

177
00:06:09,480 --> 00:06:11,240
那么我去翻下一个句子

178
00:06:11,280 --> 00:06:13,519
那么我给我的句子

179
00:06:13,519 --> 00:06:15,560
我可以用双向的去看它

180
00:06:16,920 --> 00:06:17,519
OK

181
00:06:17,759 --> 00:06:20,519
或者是说我做改写什么东西

182
00:06:20,519 --> 00:06:22,199
就是说我能够把整个句子

183
00:06:22,199 --> 00:06:24,240
在我能看到整个句子的情况下

184
00:06:24,240 --> 00:06:25,720
我对它做特征提取

185
00:06:26,199 --> 00:06:26,560
OK

186
00:06:26,560 --> 00:06:27,280
才用别的地方

187
00:06:27,280 --> 00:06:28,639
比如说语音都

188
00:06:28,680 --> 00:06:31,759
语音就是语音的识别的时候

189
00:06:31,759 --> 00:06:32,519
你也可以用一点的

190
00:06:32,519 --> 00:06:35,120
就是我可以等到你把这句话说完

191
00:06:35,639 --> 00:06:36,960
就不要一个字一个字反对

192
00:06:36,960 --> 00:06:39,040
我可以等你把一句话说完

193
00:06:39,040 --> 00:06:41,560
然后再就要来回扫一扫

194
00:06:41,560 --> 00:06:42,600
然后给你

195
00:06:43,120 --> 00:06:43,760
OK

196
00:06:44,560 --> 00:06:45,280
总结一下

197
00:06:46,520 --> 00:06:48,400
双向循环神经网络

198
00:06:48,439 --> 00:06:50,720
通过反向更新隐藏状态

199
00:06:50,720 --> 00:06:53,560
来利用反世界方向的信息

200
00:06:53,560 --> 00:06:55,320
这样做两个世界方向信息

201
00:06:55,680 --> 00:06:57,520
通常用的作用是用来做

202
00:06:57,960 --> 00:07:00,320
序列抽取特征

203
00:07:00,360 --> 00:07:01,160
就给我一个句子

204
00:07:01,160 --> 00:07:02,240
我做翻译的时候

205
00:07:02,240 --> 00:07:03,160
我们之后会看翻译

206
00:07:03,800 --> 00:07:06,040
可以说原句子里面

207
00:07:06,040 --> 00:07:07,160
就是说中文翻英文

208
00:07:07,160 --> 00:07:07,920
我中文的句子

209
00:07:07,920 --> 00:07:09,120
当然我已经知道了

210
00:07:09,120 --> 00:07:09,360
对吧

211
00:07:09,360 --> 00:07:11,480
我可以两个方向都看一下

212
00:07:11,720 --> 00:07:12,600
填空也可以

213
00:07:12,600 --> 00:07:13,800
就是填空的时候

214
00:07:13,800 --> 00:07:14,720
我中间小个词

215
00:07:14,720 --> 00:07:16,199
我两个方向去填空

216
00:07:16,840 --> 00:07:19,000
但是不能用来预测未来

217
00:07:19,000 --> 00:07:21,840
因为你未来你还没有知道

218
00:07:22,000 --> 00:07:23,800
所以你没有反信息的方向

