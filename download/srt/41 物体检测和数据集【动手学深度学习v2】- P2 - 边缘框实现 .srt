1
00:00:00,000 --> 00:00:03,560
目标检测或者叫物体检测

2
00:00:03,560 --> 00:00:05,600
或者叫object detection

3
00:00:05,600 --> 00:00:07,600
是计算机视觉里面

4
00:00:08,160 --> 00:00:12,000
也算是最用的最广泛的一个应用了

5
00:00:12,200 --> 00:00:15,280
虽然我们一开始一直在讲图片分类

6
00:00:15,320 --> 00:00:17,879
但实际在计算机视觉的应用里面

7
00:00:17,920 --> 00:00:21,000
图片分类相对来说用的没那么多

8
00:00:21,160 --> 00:00:23,240
因为你说我给你一张图片

9
00:00:23,240 --> 00:00:25,320
我说这里面有只猫有只狗

10
00:00:25,320 --> 00:00:29,480
其实在对用户来讲

11
00:00:29,480 --> 00:00:32,280
这个东西好像也不显得那么重要

12
00:00:32,280 --> 00:00:35,600
因为图片里面其实有很多东西

13
00:00:36,159 --> 00:00:38,359
目标检测或者物体检测

14
00:00:38,719 --> 00:00:40,840
其实想尝试去看一下

15
00:00:40,840 --> 00:00:43,600
这个图片里面有到底有哪些东西

16
00:00:44,679 --> 00:00:47,159
所以我们可以很简单的看一下

17
00:00:47,159 --> 00:00:49,840
就是说它跟图片分类的区别

18
00:00:51,320 --> 00:00:52,600
图片分类我们知道

19
00:00:52,920 --> 00:00:56,679
就是说在一张图片里面

20
00:00:56,679 --> 00:00:59,200
我们认为它是有一个主体

21
00:00:59,679 --> 00:01:01,640
我们去把主体找出来

22
00:01:01,840 --> 00:01:04,320
比如说左边图片有一只狗

23
00:01:04,480 --> 00:01:05,960
那么主要就是一只狗了

24
00:01:05,960 --> 00:01:08,599
别的东西都是相对来说比较少

25
00:01:09,319 --> 00:01:12,079
小或者是背景我们就不关心了

26
00:01:13,439 --> 00:01:15,840
但对目标检测来说

27
00:01:15,879 --> 00:01:17,079
就会不一样一点

28
00:01:17,520 --> 00:01:19,960
在右边这张图片里面

29
00:01:20,280 --> 00:01:22,040
有两只狗一只猫

30
00:01:22,920 --> 00:01:24,480
所以我们的任务是说

31
00:01:24,480 --> 00:01:27,600
我们要去识别里面

32
00:01:27,600 --> 00:01:29,440
所有我们感兴趣的物体

33
00:01:29,760 --> 00:01:31,800
比如说我们对猫和狗感兴趣

34
00:01:31,960 --> 00:01:35,960
我们需要把所有的猫和狗给你找出来

35
00:01:36,880 --> 00:01:38,560
而且还不仅仅是这样

36
00:01:38,800 --> 00:01:42,040
我们还需要将每个物体的位置

37
00:01:42,040 --> 00:01:42,880
给你找出来

38
00:01:44,160 --> 00:01:47,440
就是说狗在这个地方对吧

39
00:01:47,440 --> 00:01:48,880
我说我用一个框框

40
00:01:48,920 --> 00:01:50,840
我要预测狗的位置

41
00:01:50,840 --> 00:01:52,880
就通过一个方框来表示

42
00:01:53,359 --> 00:01:55,120
说这个方框里面

43
00:01:55,240 --> 00:01:56,680
我有一只狗

44
00:01:56,920 --> 00:01:59,439
这个方框里面有另外一只狗

45
00:02:00,280 --> 00:02:02,079
这个方框里面有一只猫

46
00:02:03,600 --> 00:02:04,880
所以可以看到是说

47
00:02:04,880 --> 00:02:05,920
目标检测

48
00:02:05,920 --> 00:02:08,360
其实他做的事情比图片分类多了

49
00:02:08,759 --> 00:02:11,039
当你只有一只狗的时候

50
00:02:11,039 --> 00:02:12,800
当然它可以退化成图片分类

51
00:02:12,840 --> 00:02:13,080
对吧

52
00:02:13,080 --> 00:02:15,319
我就把最主要的物体

53
00:02:15,319 --> 00:02:17,000
当做图片的类别

54
00:02:17,480 --> 00:02:19,719
但是当你的图片更加复杂的时候

55
00:02:19,719 --> 00:02:23,240
它不仅可以进行多个物体的识别

56
00:02:23,280 --> 00:02:25,759
而且能把它的位置给你找出来

57
00:02:26,120 --> 00:02:27,360
所以他就是说

58
00:02:27,360 --> 00:02:29,280
在应用场景中用的更多一点

59
00:02:29,280 --> 00:02:31,960
因为我们很有可能想知道一个图片

60
00:02:31,960 --> 00:02:32,120
里面

61
00:02:32,120 --> 00:02:34,159
到底有哪一些主要的物体

62
00:02:35,159 --> 00:02:35,719
OK

63
00:02:36,360 --> 00:02:39,000
我们给几个目标检测的应用

64
00:02:39,199 --> 00:02:40,079
给大家看一下

65
00:02:40,680 --> 00:02:44,759
第一个是看看我们是一个动画

66
00:02:45,199 --> 00:02:47,280
在无人

67
00:02:48,039 --> 00:02:50,039
基本上是无人车里面

68
00:02:50,240 --> 00:02:51,719
我们去一个视频里面

69
00:02:51,719 --> 00:02:53,719
我们不断去看每个车

70
00:02:53,719 --> 00:02:55,280
你看每个车的方框

71
00:02:55,520 --> 00:02:56,800
每个人的方框

72
00:02:57,039 --> 00:02:59,960
以及一些车灯路标之间的

73
00:03:00,360 --> 00:03:01,879
之间全部给你找出来

74
00:03:03,159 --> 00:03:05,000
这个也是目标检测

75
00:03:05,000 --> 00:03:07,879
在一个特别大的应用

76
00:03:07,879 --> 00:03:08,960
就是在无人车里面

77
00:03:09,319 --> 00:03:11,680
另外在我们课程一开始的时候

78
00:03:11,680 --> 00:03:12,599
我们有讲过

79
00:03:12,800 --> 00:03:13,439
目标检测

80
00:03:13,439 --> 00:03:16,520
在比如说无人售货里面

81
00:03:16,680 --> 00:03:17,680
我要去识别

82
00:03:17,840 --> 00:03:19,719
你到底抓了哪一个物体

83
00:03:19,719 --> 00:03:23,160
然后大概你是怎么样动的

84
00:03:23,160 --> 00:03:23,800
当然是tracking

85
00:03:24,000 --> 00:03:25,080
就是我们会识别

86
00:03:25,080 --> 00:03:26,400
是到底抓哪个物体

87
00:03:27,080 --> 00:03:27,680
OK

88
00:03:28,600 --> 00:03:30,240
所以我们就直接来讲一下

89
00:03:30,240 --> 00:03:30,920
里面

90
00:03:31,360 --> 00:03:32,360
一个重要的概念

91
00:03:32,360 --> 00:03:34,240
叫做边缘框

92
00:03:34,240 --> 00:03:35,800
或者叫bonding box

93
00:03:36,000 --> 00:03:38,080
它是用来表示你这个物体

94
00:03:38,080 --> 00:03:39,040
它的位置

95
00:03:40,200 --> 00:03:41,160
当然你有一个物体

96
00:03:41,160 --> 00:03:42,719
你的位置有很多种表示方法

97
00:03:42,920 --> 00:03:45,800
你可以说我们这个是苟在这个地方

98
00:03:45,920 --> 00:03:46,760
当然我是说

99
00:03:46,760 --> 00:03:47,920
我如果想可以做一个

100
00:03:47,920 --> 00:03:49,840
精细一点的边缘

101
00:03:49,840 --> 00:03:50,840
这是可以做的

102
00:03:51,320 --> 00:03:52,360
这个是在另外一个应用

103
00:03:52,360 --> 00:03:53,880
我们也会给大家讲到

104
00:03:54,240 --> 00:03:55,400
但这里的话

105
00:03:55,400 --> 00:03:57,280
我们说这只狗的位置

106
00:03:57,280 --> 00:03:58,320
我们就是说

107
00:03:58,320 --> 00:04:00,400
用一个大概的一个边框

108
00:04:00,400 --> 00:04:01,760
把它框在一起

109
00:04:02,800 --> 00:04:03,439
比如说

110
00:04:03,800 --> 00:04:04,880
蓝框就表示

111
00:04:05,200 --> 00:04:06,760
狗的位置在这个地方

112
00:04:07,120 --> 00:04:08,840
红框就表示猫的位置

113
00:04:10,000 --> 00:04:12,400
一个边框可以用4个数字来定义

114
00:04:12,880 --> 00:04:15,320
比如说有两种常用的定义方法

115
00:04:15,319 --> 00:04:16,079
一个是说

116
00:04:16,079 --> 00:04:18,079
我说左上点的

117
00:04:18,319 --> 00:04:20,159
x坐标和y坐标

118
00:04:20,800 --> 00:04:23,000
你的x就是60

119
00:04:23,159 --> 00:04:25,879
从x是0在这个地方开始的

120
00:04:25,879 --> 00:04:28,600
y的0就是经常比较奇怪的

121
00:04:28,600 --> 00:04:29,159
是y的0

122
00:04:29,159 --> 00:04:31,199
我们通常是从这个地方开始

123
00:04:31,360 --> 00:04:33,279
所以它的原点其实在这个地方

124
00:04:33,319 --> 00:04:35,360
和你的坐标轴是有点不一样的

125
00:04:36,039 --> 00:04:37,839
所以你这个地方就是

126
00:04:37,959 --> 00:04:38,959
x轴是60

127
00:04:38,959 --> 00:04:40,000
y轴是45

128
00:04:40,800 --> 00:04:43,639
然后你的右下角就是这个地方

129
00:04:44,599 --> 00:04:45,479
你看到是说

130
00:04:45,479 --> 00:04:46,680
我的x轴

131
00:04:46,680 --> 00:04:48,719
大概在400下面一点点

132
00:04:48,719 --> 00:04:50,680
就是具体来说是378

133
00:04:51,120 --> 00:04:53,719
你的y轴就是在500那么多一点点

134
00:04:53,719 --> 00:04:55,120
具体来说是516

135
00:04:56,240 --> 00:04:56,839
OK

136
00:04:57,839 --> 00:04:59,519
另外一个表示方法是说

137
00:04:59,519 --> 00:05:01,199
你可以用另外4个数字

138
00:05:02,000 --> 00:05:02,839
一个是说

139
00:05:02,839 --> 00:05:03,599
我还是一样的

140
00:05:03,599 --> 00:05:05,759
用左上的x和左上的y

141
00:05:06,479 --> 00:05:07,800
那么接下来是说

142
00:05:07,800 --> 00:05:10,079
我不需要右下的坐标了

143
00:05:10,079 --> 00:05:11,399
我只要说宽是多

144
00:05:11,399 --> 00:05:13,399
就是这个边长是多少

145
00:05:13,919 --> 00:05:15,839
高是多少

146
00:05:16,000 --> 00:05:17,279
那么有边长的话

147
00:05:17,279 --> 00:05:18,279
那么把x一加

148
00:05:18,279 --> 00:05:20,879
就知道右下的x

149
00:05:21,079 --> 00:05:21,919
有高的话

150
00:05:21,919 --> 00:05:24,959
那么我把左上的y和高一加

151
00:05:24,959 --> 00:05:26,360
就得到了右下的y

152
00:05:27,120 --> 00:05:27,639
OK

153
00:05:27,879 --> 00:05:30,199
这是一个说一个边缘框

154
00:05:30,199 --> 00:05:32,079
可以用4个数字来定

155
00:05:32,519 --> 00:05:35,240
这个数字也就是我们要去预测边框

156
00:05:35,240 --> 00:05:36,519
的时候要预测的事情

157
00:05:37,279 --> 00:05:38,919
但是从标注上来说

158
00:05:39,120 --> 00:05:43,000
你说我到底是边框是长什么样子

159
00:05:43,919 --> 00:05:45,439
就是说你会发现说

160
00:05:45,599 --> 00:05:48,479
其实我要标它的话

161
00:05:49,039 --> 00:05:50,680
我说我要这么标

162
00:05:50,680 --> 00:05:52,759
其实也可以对吧

163
00:05:52,759 --> 00:05:53,680
你说我画一个

164
00:05:53,680 --> 00:05:55,519
稍微过来一点点的框

165
00:05:55,519 --> 00:05:56,439
这么画下来

166
00:05:57,079 --> 00:05:58,360
其实也行对不对

167
00:05:59,039 --> 00:06:02,800
我想把狗的脚这个地方给你标进去

168
00:06:02,800 --> 00:06:03,919
就是这一块标进去

169
00:06:05,279 --> 00:06:07,759
当然是说我也可以在别的地方

170
00:06:07,759 --> 00:06:10,439
就是说稍微那么动一动没关系

171
00:06:10,800 --> 00:06:13,319
所以就是说在标注的时候

172
00:06:13,519 --> 00:06:16,439
一般来说是我就是找个人

173
00:06:16,439 --> 00:06:17,560
找一些人

174
00:06:17,759 --> 00:06:19,159
给我在里面画框框

175
00:06:19,759 --> 00:06:20,439
就画一个框

176
00:06:20,759 --> 00:06:23,159
就是拿个鼠标拖一下画个框

177
00:06:23,800 --> 00:06:26,439
当然是说一般来说会告诉你说

178
00:06:26,560 --> 00:06:28,399
你尽量把物体给框在里面

179
00:06:28,639 --> 00:06:31,159
但是如果这个物体长得比较奇怪

180
00:06:31,159 --> 00:06:33,079
就长出去很远的话

181
00:06:33,079 --> 00:06:34,800
有个脚就伸出去很远的话

182
00:06:34,800 --> 00:06:36,600
你也可以脚不在也没关系

183
00:06:37,279 --> 00:06:39,319
通常来说就是说

184
00:06:39,319 --> 00:06:41,719
因为你那人鼠标一画

185
00:06:41,760 --> 00:06:45,400
就是很容易多一点少一点偏一点

186
00:06:45,600 --> 00:06:49,680
所以一般来说我们会找几个人

187
00:06:49,920 --> 00:06:52,120
然后大家一起画一下框

188
00:06:52,280 --> 00:06:53,840
然后可能对这几个框

189
00:06:53,840 --> 00:06:57,440
我们做一下平均或者之类的处理

190
00:06:57,680 --> 00:06:58,200
OK

191
00:06:58,320 --> 00:06:59,520
所以相对来说

192
00:06:59,520 --> 00:07:01,400
你在标注图片的时候

193
00:07:01,400 --> 00:07:02,640
就图片分类的时候

194
00:07:02,640 --> 00:07:03,720
我给张图片

195
00:07:03,840 --> 00:07:05,840
我就只要把标号找出来

196
00:07:05,880 --> 00:07:08,160
但你物体识别标注就会困难一些

197
00:07:08,360 --> 00:07:10,800
首先你假设里面一张图片

198
00:07:10,800 --> 00:07:12,360
平均有5个物体的话

199
00:07:12,400 --> 00:07:16,079
那么至少是5倍于图片分类的成本

200
00:07:16,079 --> 00:07:18,680
因为你说我要把5个物体给你说

201
00:07:18,840 --> 00:07:20,439
这5个物体分别是谁

202
00:07:21,040 --> 00:07:24,199
接下来是说你还得画个5个框

203
00:07:24,639 --> 00:07:26,240
画5个框是有成本的

204
00:07:26,240 --> 00:07:30,040
所以是说物体识别和目标识别的

205
00:07:30,040 --> 00:07:30,720
数据集

206
00:07:30,720 --> 00:07:33,879
通常来说比图片分类的数据集

207
00:07:33,879 --> 00:07:35,360
要小很多

208
00:07:35,439 --> 00:07:37,879
这是因为标注的成本很高

209
00:07:39,680 --> 00:07:40,319
OK

210
00:07:40,920 --> 00:07:42,480
但是说到数据集

211
00:07:43,079 --> 00:07:44,520
数据集的话

212
00:07:45,000 --> 00:07:46,400
一般来说图片分类

213
00:07:46,400 --> 00:07:47,800
我们之前有看到

214
00:07:48,040 --> 00:07:52,079
最简单是我给你一个CSV文件

215
00:07:52,079 --> 00:07:54,560
说哪张图片它的标号是谁

216
00:07:54,879 --> 00:07:56,680
或者说我可以给你

217
00:07:57,080 --> 00:07:58,519
放在一个文件夹里面

218
00:07:58,560 --> 00:08:00,759
每一个类是一个子文件夹

219
00:08:00,840 --> 00:08:02,360
对应的它的标号的图片

220
00:08:02,360 --> 00:08:04,040
放在子文件夹下面

221
00:08:04,080 --> 00:08:05,800
这是图片分类的数据集

222
00:08:05,879 --> 00:08:08,040
它又表示起来比较方便

223
00:08:08,360 --> 00:08:09,920
但目标检测数据集

224
00:08:10,439 --> 00:08:13,680
那就是会后面一种方法就不能用了

225
00:08:13,680 --> 00:08:16,520
因为一个图片里面可能要多个类

226
00:08:16,640 --> 00:08:18,520
所以你不能放在子文件夹里

227
00:08:19,480 --> 00:08:20,439
所以通常来说

228
00:08:20,560 --> 00:08:22,160
目标检测数据集

229
00:08:22,160 --> 00:08:24,520
是它的标号是要额外存的

230
00:08:24,759 --> 00:08:26,720
一般你有很多种办法

231
00:08:26,840 --> 00:08:29,600
一般常用的是最简单的一个办法

232
00:08:29,600 --> 00:08:31,560
是说我每一行

233
00:08:31,600 --> 00:08:33,600
假设你说个文本文件存的话

234
00:08:33,720 --> 00:08:35,560
我每一行表示一个物体

235
00:08:36,240 --> 00:08:39,759
然后这里面分别有文件名字

236
00:08:40,559 --> 00:08:42,360
然后你的物体的类别

237
00:08:43,360 --> 00:08:44,679
然后它的边缘框

238
00:08:46,120 --> 00:08:48,159
就是说因为你一个文件名

239
00:08:48,159 --> 00:08:49,839
文件里面一个图片里面

240
00:08:49,839 --> 00:08:51,559
可能有多个物体的话

241
00:08:51,599 --> 00:08:52,919
那么说同一个文件名

242
00:08:52,919 --> 00:08:54,679
可能会出现多次

243
00:08:55,319 --> 00:08:56,599
假设你有5个物体的话

244
00:08:56,599 --> 00:08:58,120
这个文件名会出现5次

245
00:08:58,159 --> 00:09:00,000
因为它每一行表示的是一个

246
00:09:00,000 --> 00:09:01,519
图片里面的一个物体

247
00:09:02,559 --> 00:09:05,159
然后接下来就是你标号了

248
00:09:05,399 --> 00:09:07,240
接下来是说你这个物体

249
00:09:07,279 --> 00:09:09,559
对应的在这个图片里面的位置

250
00:09:09,800 --> 00:09:11,080
它那个边缘框的位置

251
00:09:11,080 --> 00:09:12,000
就是4个数字

252
00:09:12,720 --> 00:09:14,120
所以就是说你看到的是

253
00:09:14,120 --> 00:09:16,520
每一行里面有1个2个加4个

254
00:09:16,520 --> 00:09:17,360
有6个值

255
00:09:19,040 --> 00:09:21,000
在目标检测里面

256
00:09:21,000 --> 00:09:23,760
一个常见的数据叫做Coco

257
00:09:24,080 --> 00:09:26,960
是可以通过网址去访问

258
00:09:27,000 --> 00:09:29,920
就是有点像ImageNet

259
00:09:29,920 --> 00:09:31,520
在图片分类里面的地位

260
00:09:31,880 --> 00:09:33,960
就是它相对来说是比较大的

261
00:09:34,120 --> 00:09:36,400
就是说它有80个物体

262
00:09:36,400 --> 00:09:38,000
就是每个物体就换这个地方

263
00:09:38,000 --> 00:09:39,799
可以看到是伞

264
00:09:40,600 --> 00:09:41,000
人

265
00:09:43,200 --> 00:09:45,559
就交通标识这种飞机

266
00:09:46,320 --> 00:09:48,600
然后一些日常用品

267
00:09:49,320 --> 00:09:50,440
电脑什么的

268
00:09:50,759 --> 00:09:52,639
就是说它相对来说

269
00:09:52,639 --> 00:09:54,600
比ImageNet接地气一点

270
00:09:54,799 --> 00:09:55,480
一般来说

271
00:09:55,480 --> 00:09:57,679
都是我们日常生活中看到的图片

272
00:09:57,960 --> 00:09:59,200
你可以看到就大量的

273
00:09:59,200 --> 00:10:01,480
基本上都是一些人照物体

274
00:10:01,679 --> 00:10:03,720
就没有什么猫猫

275
00:10:03,759 --> 00:10:04,600
狗狗在里面

276
00:10:04,600 --> 00:10:05,960
就有一点有猫猫

277
00:10:06,000 --> 00:10:06,840
狗狗还是有的

278
00:10:06,960 --> 00:10:08,800
但是没有特别奇怪的动物

279
00:10:09,000 --> 00:10:10,720
一大块就是人

280
00:10:10,720 --> 00:10:12,280
常见的人照物体

281
00:10:13,440 --> 00:10:16,399
它的类别数远远的少于ImageNet

282
00:10:16,440 --> 00:10:18,160
它只有80个类别

283
00:10:18,960 --> 00:10:20,160
ImageNet有一千类

284
00:10:21,560 --> 00:10:22,440
所以它就是说

285
00:10:22,440 --> 00:10:25,360
对于80个常见物体的目标检测

286
00:10:26,120 --> 00:10:28,800
它大概是有33万张图片

287
00:10:29,280 --> 00:10:30,519
它的图片就是说

288
00:10:30,519 --> 00:10:31,080
ImageNet

289
00:10:31,080 --> 00:10:32,680
你现在用的是120万张

290
00:10:32,680 --> 00:10:33,840
所以它是少一点

291
00:10:34,000 --> 00:10:37,080
但是它有每张图片里面

292
00:10:37,080 --> 00:10:38,240
标了多个物体

293
00:10:38,240 --> 00:10:39,600
就是有1.5万

294
00:10:39,600 --> 00:10:41,480
150万个物体

295
00:10:41,680 --> 00:10:45,240
所以说Coco也是一个很大的数据机了

296
00:10:45,360 --> 00:10:47,080
大概是个ImageNet的

297
00:10:47,399 --> 00:10:49,320
大概是等量的一个数据机

298
00:10:49,399 --> 00:10:50,320
也就是说

299
00:10:50,879 --> 00:10:52,080
在学术界是用的

300
00:10:52,080 --> 00:10:53,560
非常广泛的一个数据机

301
00:10:55,600 --> 00:10:56,519
OK总结一下

302
00:10:57,280 --> 00:10:59,600
就物体检测或者目标检测

303
00:11:00,080 --> 00:11:04,840
去识别图片里面的多个物体的类别

304
00:11:04,879 --> 00:11:05,879
和它的位置

305
00:11:06,600 --> 00:11:08,200
它跟图片分类的不一样

306
00:11:08,200 --> 00:11:10,920
是说我可能会把里面

307
00:11:10,920 --> 00:11:13,960
我感兴趣的多个物体给你找出来

308
00:11:15,720 --> 00:11:16,800
另外我还要知道

309
00:11:16,800 --> 00:11:18,159
它们的位置在什么地方

310
00:11:19,399 --> 00:11:22,440
位置通常一般是用一个变框来表示

311
00:11:22,440 --> 00:11:23,519
就是一个方框

312
00:11:23,639 --> 00:11:24,240
一个方框

313
00:11:24,240 --> 00:11:26,000
你通常就有4个数字来表示

314
00:11:26,040 --> 00:11:27,960
你用左上右下的坐标

315
00:11:27,960 --> 00:11:30,680
或者是左上加上高和宽

316
00:11:30,840 --> 00:11:33,600
OK这就是一个我们新的应用的

317
00:11:33,600 --> 00:11:35,120
一个很简单的介绍

